<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a4a11d514c7d463668e07712114998e6.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.30">

  <meta name="author" content="Prof.&nbsp;Calvin">
  <title>Systems in Rust – IEEE 754</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-83ff8eaca933b935d6975c751fe501e4.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">IEEE 754</h1>
  <p class="subtitle">Systems in Rust</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Calvin 
</div>
</div>
</div>

</section>
<section id="announcements" class="slide level2">
<h2>Announcements</h2>
<ul>
<li><strong>Welcome</strong> to Systems in Rust</li>
<li><strong>Action Items</strong>:
<ul>
<li>“SHA-512” is due on next Friday</li>
<li>Lecture on numbers, inspired by the lab, while we wait.</li>
</ul></li>
</ul>
</section>
<section id="today" class="slide level2">
<h2>Today</h2>
<ul>
<li>Understand the basics of floats</li>
<li>Understand the language of floats</li>
<li>Get a feel for when further investigation is required</li>
<li>Have a few tools ready to help</li>
<li>Be prepared to keep learning about IEEE floats</li>
</ul>
</section>
<section id="citation" class="slide level2">
<h2>Citation</h2>
<ul>
<li>Yoinked</li>
<li><a href="https://github.com/DigitalInBlue/CPPCon2015">url</a></li>
<li>Author John Farrier, Booz Allen Hamilton</li>
</ul>
</section>
<section id="mission-statement" class="slide level2">
<h2>Mission Statement</h2>
<ul>
<li>I’m a normal person.
<ul>
<li>I think <code>5/2</code> is <code>2.5</code> or perhaps 2½.</li>
</ul></li>
<li>I’m a scientist.
<ul>
<li>I’m solving “Black-Scholes”</li>
<li><a href="https://numba.pydata.org/numba-examples/examples/finance/blackscholes/results.html">Does anyone know what this is doing?</a> <span class="math display">\[
d_2 = d_1 - \sigma\sqrt{T - t} = \frac{1}{\sigma\sqrt{T - t}}\left[\ln\left(\frac{S_t}{K}\right) + \left(r - q - \frac{1}{2}\sigma^2\right)(T - t)\right]
\]</span></li>
</ul></li>
</ul>
</section>
<section id="common-fallacies" class="slide level2">
<h2>Common Fallacies</h2>
<ul>
<li>“Floating point numbers are numbers”
<ul>
<li><code>max(count())</code> Pinocchios</li>
</ul></li>
<li>“It’s floating point error”
<ul>
<li>“All floating point involves magical rounding errors”</li>
</ul></li>
<li>“Linux and Windows handle floats differently”</li>
<li>“Floating point represents an interval value near the actual value”</li>
</ul>
</section>
<section id="common-fallacies-2.0" class="slide level2">
<h2>Common Fallacies 2.0</h2>
<ul>
<li>“A double (an <code>f64</code>) holds 15 decimal places and I only need 3, so I have nothing to worry about”<sup>1</sup></li>
<li>“My programming language does better math than your programming language”<sup>2</sup></li>
<li>“Why can’t computers just store whatever number I use”<sup>3</sup></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Grammatically, this statement should be “so I have nothing about which to worry.”</p></li><li id="fn2"><p>This is true in the special case that your programming language is Haskell.</p></li><li id="fn3"><p>This is due to how many numbers there are.</p></li></ol></aside></section>
<section id="anatomy-of-ieee-floats" class="slide level2">
<h2>Anatomy of IEEE Floats</h2>

<img data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/IEEE754.svg/550px-IEEE754.svg.png" class="r-stretch"></section>
<section id="ieee-float-specification" class="slide level2">
<h2>IEEE Float Specification</h2>
<ul>
<li>IEEE 754-1985, IEEE 854-1987, IEEE 754-2008
<ul>
<li>These are paywalled.</li>
<li>Those are years.</li>
</ul></li>
<li>Provide for portable, provably consistent math
<ul>
<li>Consistent, not correct.</li>
</ul></li>
</ul>
</section>
<section id="assurances" class="slide level2">
<h2>Assurances</h2>
<ul>
<li>Ensure some significant mathematical identities hold true:
<ul>
<li><span class="math inline">\(x + y  = y + x\)</span>
<ul>
<li>Symmetry of addition</li>
</ul></li>
<li><span class="math inline">\(x + 0 = x\)</span>
<ul>
<li>Additive identity</li>
</ul></li>
<li><span class="math inline">\(x = y \implies x - y = 0\)</span>
<ul>
<li>Identity under subtraction</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="assurances-2.0" class="slide level2">
<h2>Assurances 2.0</h2>
<p><span class="math display">\[
\frac{x}{\sqrt{x^2+y^2}} \leq 1
\]</span></p>
<ul>
<li>What is missing?</li>
</ul>
</section>
<section id="ieee-float-specification-1" class="slide level2">
<h2>IEEE Float Specification</h2>
<ul>
<li>Ensure every floating point number is unique</li>
<li>Ensure every floating point number has an opposite
<ul>
<li><em>Zero</em> is a special case because of this</li>
</ul></li>
<li>Specifies algorithms for addition, subtraction, multiplication, division, and square-root
<ul>
<li>Not really operations/relations! They are algorithms.</li>
</ul></li>
</ul>
</section>
<section id="aside-scientific-notation" class="slide level2">
<h2>Aside: Scientific Notation</h2>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/Scientific_notation">Scientific notation is a way of expressing numbers that are too large or too small to be conveniently written in decimal form, since to do so would require writing out an inconveniently long string of digits.</a></p>
</blockquote>
<ul>
<li>In scientific notation, nonzero numbers are written in the form</li>
</ul>
<p><span class="math display">\[a \times 10^b\]</span></p>
</section>
<section id="aside-explanation" class="slide level2">
<h2>Aside: Explanation</h2>
<ul>
<li>In scientific notation, nonzero numbers are written in the form</li>
</ul>
<p><span class="math display">\[a \times 10^b\]</span></p>
<ul>
<li><span class="math inline">\(a\)</span> (the coefficient or mantissa) is a number greater than or equal to 1 and less than 10 (<span class="math inline">\(1 \le |a| &lt; 10\)</span>).</li>
<li><span class="math inline">\(10\)</span> is the base.</li>
<li><span class="math inline">\(b\)</span> (the exponent) is an integer.</li>
</ul>
</section>
<section id="aside-physical-examples" class="slide level2">
<h2>Aside: Physical Examples</h2>
<ol type="1">
<li><p><strong>Speed of light:</strong> The speed of light in a vacuum is approximately <span class="math inline">\(300,000,000 \text{ m/s}\)</span> <span class="math display">\[
3 \times 10^8 \text{ m/s}
\]</span></p></li>
<li><p><strong>Mass of an electron:</strong> The mass of an electron is approximately <span class="math inline">\(0.00000000000000000000000000091093837 \text{ g}\)</span>. <span class="math display">\[
9.1093837 \times 10^{-28} \text{ g}
\]</span></p></li>
</ol>
</section>
<section id="aside-economic-examples" class="slide level2">
<h2>Aside: Economic Examples</h2>
<ul>
<li>We can use social science numbers.</li>
<li><a href="https://www.newyorkfed.org/research/college-labor-market#--:explore:outcomes-by-major">Labor Market Outcomes of College Graduates by Major</a></li>
<li>Computer Science majors in 2023 have a $80,000 median wage “early career”
<ul>
<li><span class="math inline">\(8.0000 \times 10^4\)</span></li>
</ul></li>
<li>And 6.1% unemployment
<ul>
<li><span class="math inline">\(6.1 \times 10^{-2}\)</span></li>
</ul></li>
</ul>
</section>
<section id="ieee-layout" class="slide level2">
<h2>IEEE Layout</h2>
<ul>
<li>An approximation using scientific notation
<ul>
<li><span class="math inline">\(x = -1^s \times 2^e \times 1.m\)</span></li>
<li><span class="math inline">\(x = -1^{\text{sign bit}} \times \text{base} 2^{\text{exponent}} \times 1.\text{mantissa}\)</span>
<ul>
<li>Where the mantissa is the technical term for the the digits after the decimal point.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="with-binary" class="slide level2 smaller">
<h2>With Binary</h2>
<ul>
<li><span class="math inline">\(x = -0b1^{\text{0b0}} \times 0b10^{\text{0b10000000}}  \times 0b1.10010010000111111011011\)</span></li>
<li>Express in memory as the concatenation:
<ul>
<li><code>0b0</code> to <code>0b10000000</code> to <code>0b10010010000111111011011</code></li>
<li><code>01000000010010010000111111011011</code></li>
</ul></li>
</ul>
</section>
<section id="singles-and-doubles" class="slide level2">
<h2>Singles and Doubles</h2>
<ul>
<li>32 - bits = 1 sign bit + 8 exponent bits + 23 mantissa bits
<ul>
<li><code>0b0</code> to <code>0b10000000</code> to <code>0b10010010000111111011011</code></li>
</ul></li>
<li>64 - bits = 1 sign bit + 12 exponent bits + 52 mantissa bits</li>
</ul>
</section>
<section id="understanding-check" class="slide level2">
<h2>Understanding check</h2>
<ul>
<li>What is the probability a <em>real number</em> <span class="math inline">\(a \in \mathbb{R}\)</span> has an exact float representation?</li>
<li>What is the probability an <em>integer</em> <span class="math inline">\(n \in \mathbb{Z}\)</span> has an exact float representation?</li>
<li>What is the probability a <em>course number</em> <span class="math inline">\(n &lt; 600\)</span> has an exact float representation?</li>
</ul>
</section>
<section id="special-floats---nan" class="slide level2">
<h2>Special Floats - NaN</h2>
<ul>
<li>Divide by Zero
<ul>
<li>1 / 0</li>
</ul></li>
<li>Not a Number (NaN)</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> numpy <span class="im">import</span> float32 <span class="im">as</span> f32</span>
<span id="cb1-2"><a></a><span class="op">&gt;&gt;&gt;</span> f32(<span class="dv">1</span>)<span class="op">/</span>f32(<span class="dv">0</span>)</span>
<span id="cb1-3"><a></a><span class="op">&lt;</span>stdin<span class="op">&gt;</span>:<span class="dv">1</span>: <span class="pp">RuntimeWarning</span>: divide by zero encountered <span class="kw">in</span> scalar divide</span>
<span id="cb1-4"><a></a>np.float32(inf)</span>
<span id="cb1-5"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">1</span><span class="op">/</span><span class="dv">0</span></span>
<span id="cb1-6"><a></a>Traceback (most recent call last):</span>
<span id="cb1-7"><a></a>  File <span class="st">"&lt;stdin&gt;"</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb1-8"><a></a><span class="pp">ZeroDivisionError</span>: division by zero</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="special-floats---inf" class="slide level2">
<h2>Special Floats - inf</h2>
<ul>
<li>Signed Infinity
<ul>
<li>Overflow protection</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="op">&gt;&gt;&gt;</span> f32(<span class="dv">10</span>) <span class="op">**</span> f32(<span class="dv">100</span>)</span>
<span id="cb2-2"><a></a><span class="op">&lt;</span>stdin<span class="op">&gt;</span>:<span class="dv">1</span>: <span class="pp">RuntimeWarning</span>: overflow encountered <span class="kw">in</span> scalar power</span>
<span id="cb2-3"><a></a>np.float32(inf)</span>
<span id="cb2-4"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="fl">10.0</span> <span class="op">**</span> <span class="dv">10000</span></span>
<span id="cb2-5"><a></a>Traceback (most recent call last):</span>
<span id="cb2-6"><a></a>File <span class="st">"&lt;stdin&gt;"</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb2-7"><a></a><span class="pp">OverflowError</span>: (<span class="dv">34</span>, <span class="st">'Numerical result out of range'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="infinity-is-signed" class="slide level2">
<h2>Infinity is signed</h2>
<ul>
<li>We can get negative infinity through a variety of means.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="op">-</span>(f32(<span class="dv">10</span>) <span class="op">**</span> f32(<span class="dv">100</span>))</span>
<span id="cb3-2"><a></a>np.float32(<span class="op">-</span>inf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>We note that this suppresses the overflow error use <code>()</code></li>
<li>In some languages this is not ever regarded as an overflow error, like Julia (where we have to use larger powers due to the f64 default)</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource jl number-lines code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a></a>julia<span class="op">&gt;</span> <span class="fl">10.0</span><span class="op">^</span><span class="fl">10000</span></span>
<span id="cb4-2"><a></a><span class="cn">Inf</span></span>
<span id="cb4-3"><a></a></span>
<span id="cb4-4"><a></a>julia<span class="op">&gt;</span> <span class="fu">-</span>(<span class="fl">10.0</span><span class="op">^</span><span class="fl">10000</span>)</span>
<span id="cb4-5"><a></a><span class="op">-</span><span class="cn">Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="signed-zero" class="slide level2">
<h2>Signed Zero</h2>
<ul>
<li>Signed Zero
<ul>
<li>Underflow protection, preserves sign</li>
<li><ul>
<li>0 =− 0</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="op">-</span><span class="dv">1</span> <span class="op">/</span> <span class="dv">10</span> <span class="op">**</span> <span class="dv">1000</span></span>
<span id="cb5-2"><a></a><span class="op">-</span><span class="fl">0.0</span></span>
<span id="cb5-3"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="fl">0.0</span> <span class="op">==</span> (<span class="op">-</span><span class="dv">1</span> <span class="op">/</span> <span class="dv">10</span> <span class="op">**</span> <span class="dv">1000</span>)</span>
<span id="cb5-4"><a></a><span class="va">True</span></span>
<span id="cb5-5"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="op">-</span><span class="fl">0.0</span></span>
<span id="cb5-6"><a></a><span class="op">-</span><span class="fl">0.0</span></span>
<span id="cb5-7"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="fl">0.0</span> <span class="op">-</span> <span class="fl">0.0</span></span>
<span id="cb5-8"><a></a><span class="fl">0.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>Works in base Python (e.g.&nbsp;don’t need NumPy).</li>
<li>Couldn’t get it to work in Julia actually (went to -inf or NaN)</li>
</ul>
</section>
<section id="simple-example" class="slide level2">
<h2>Simple Example</h2>
<ul>
<li>Floating point is great because it will work exactly how you expect.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="fl">0.1</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">==</span> <span class="fl">0.3</span></span>
<span id="cb6-2"><a></a><span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>More or less.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="fl">0.1</span> <span class="op">+</span> <span class="fl">0.2</span></span>
<span id="cb7-2"><a></a><span class="fl">0.30000000000000004</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="simple-example-1" class="slide level2">
<h2>Simple Example</h2>
<ul>
<li>We shouldn’t be suprised by this!</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="op">&gt;&gt;&gt;</span> _ <span class="op">=</span> [<span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>f32(i<span class="op">/</span><span class="dv">10</span>)<span class="sc">:1.100}</span><span class="ss">"</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">4</span>)]</span>
<span id="cb8-2"><a></a><span class="fl">0.100000001490116119384765625</span></span>
<span id="cb8-3"><a></a><span class="fl">0.20000000298023223876953125</span></span>
<span id="cb8-4"><a></a><span class="fl">0.300000011920928955078125</span></span>
<span id="cb8-5"><a></a><span class="op">&gt;&gt;&gt;</span> _ <span class="op">=</span> [<span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>f64(i<span class="op">/</span><span class="dv">10</span>)<span class="sc">:1.100}</span><span class="ss">"</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">4</span>)]</span>
<span id="cb8-6"><a></a><span class="fl">0.1000000000000000055511151231257827021181583404541015625</span></span>
<span id="cb8-7"><a></a><span class="fl">0.200000000000000011102230246251565404236316680908203125</span></span>
<span id="cb8-8"><a></a><span class="fl">0.299999999999999988897769753748434595763683319091796875</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="storage-of-1." class="slide level2">
<h2>Storage of 1.</h2>
<ul>
<li><span class="math inline">\(x = -1^s \times 2^e \times 1.m\)</span></li>
<li><span class="math inline">\(x = -1^{\text{sign bit}} \times \text{base} 2^{\text{exponent}} \times 1.\text{mantissa}\)</span></li>
<li><span class="math inline">\(x = -1^{\text{sign bit}} \times \text{base} 2^{\text{exponent}} \times 1 + \text{mantissa} \times \frac{1}{2^n}\)</span></li>
<li><span class="math inline">\(1 = -1^0 \times 2^0 \times (1 + 0 \times \frac{1}{2^n}\)</span></li>
<li>So each of the sign bit, the base, and the mantissa are zero.
<ul>
<li>I should note I was unable to reproduce this in Rust or C.</li>
<li>I’m not really a floating pointer.</li>
</ul></li>
</ul>
</section>
<section id="except" class="slide level2">
<h2>Except…</h2>
<ul>
<li>This is actually a little bit fake.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource rs number-lines code-with-copy"><code class="sourceCode rust"><span id="cb9-1"><a></a><span class="op">$</span> cat src<span class="op">/</span>main<span class="op">.</span>rs</span>
<span id="cb9-2"><a></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb9-3"><a></a>    <span class="kw">let</span> x<span class="op">:</span><span class="dt">f32</span> <span class="op">=</span> <span class="dv">1.0</span><span class="op">;</span></span>
<span id="cb9-4"><a></a>    <span class="pp">println!</span>(<span class="st">"{:032b}"</span><span class="op">,</span> x<span class="op">.</span>to_bits())<span class="op">;</span></span>
<span id="cb9-5"><a></a><span class="op">}</span></span>
<span id="cb9-6"><a></a><span class="op">$</span> cargo run</span>
<span id="cb9-7"><a></a>    Finished `dev` profile [unoptimized <span class="op">+</span> debuginfo] target(s) <span class="kw">in</span> <span class="dv">0</span><span class="op">.</span>00s</span>
<span id="cb9-8"><a></a>     Running `target<span class="op">/</span>debug<span class="op">/</span>bits`</span>
<span id="cb9-9"><a></a><span class="dv">00111111100000000000000000000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>What is that?</li>
</ul>
</section>
<section id="shift-127" class="slide level2">
<h2>Shift 127</h2>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/Floating-point_arithmetic#Internal_representation">While the exponent can be positive or negative, in binary formats it is stored as an unsigned number that has a fixed “bias” added to it.</a></p>
</blockquote>
<ul>
<li>The IEEE 754 binary format specifies a hardware implementation of such that the exponent, be it positive or negative, in binary formats is stored as an unsigned number that has a fixed “bias” added to it.</li>
<li>In the case of 32 bit floats, the bias is 127.</li>
</ul>
</section>
<section id="breakdown" class="slide level2">
<h2>Breakdown</h2>
<ul>
<li>Take the following:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a></a><span class="ex">00111111100000000000000000000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>That is:
<ul>
<li>Sign bit of <code>0</code></li>
<li>Exponent of <code>01111111</code>
<ul>
<li>All zeroes and all ones are reserved for <code>NaN</code>, <code>inf</code>, etc.</li>
</ul></li>
<li>Mantissa of 23 zeroes.</li>
</ul></li>
</ul>
</section>
<section id="how-precise" class="slide level2">
<h2>How precise?</h2>
<ul>
<li>I have referred to <code>f32</code> as having “32 bits of precision”.</li>
<li>How much precision is that?</li>
<li>Well, let’s set the least significant bit of the mantissa to one.</li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>main.rs</strong></pre>
</div>
<div class="sourceCode" id="cb11" data-filename="main.rs"><pre class="sourceCode numberSource rs number-lines code-with-copy"><code class="sourceCode rust"><span id="cb11-1"><a></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb11-2"><a></a>    <span class="kw">let</span> x<span class="op">:</span><span class="dt">f32</span> <span class="op">=</span> <span class="dv">1.0</span><span class="op">;</span></span>
<span id="cb11-3"><a></a>    <span class="kw">let</span> <span class="kw">mut</span> b<span class="op">:</span><span class="dt">u32</span> <span class="op">=</span> x<span class="op">.</span>to_bits()<span class="op">;</span></span>
<span id="cb11-4"><a></a>    b <span class="op">|=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb11-5"><a></a>    <span class="pp">println!</span>(<span class="st">"{:032b}"</span><span class="op">,</span> b)<span class="op">;</span></span>
<span id="cb11-6"><a></a>    <span class="pp">println!</span>(<span class="st">"{:1.32}"</span><span class="op">,</span> <span class="dt">f32</span><span class="pp">::</span>from_bits(b))<span class="op">;</span></span>
<span id="cb11-7"><a></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="epsilon" class="slide level2">
<h2>“Epsilon”</h2>
<ul>
<li>What do we get?</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a></a><span class="ex">$</span> cargo run</span>
<span id="cb12-2"><a></a>    <span class="ex">Finished</span> <span class="kw">`</span><span class="ex">dev</span><span class="kw">`</span> profile [unoptimized + debuginfo] target<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="er">in</span> <span class="ex">0.00s</span></span>
<span id="cb12-3"><a></a>     <span class="ex">Running</span> <span class="kw">`</span><span class="ex">target/debug/bits</span><span class="kw">`</span></span>
<span id="cb12-4"><a></a><span class="ex">00111111100000000000000000000001</span></span>
<span id="cb12-5"><a></a><span class="ex">1.00000011920928955078125000000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>We refer to this value (less one) as <a href="https://en.wikipedia.org/wiki/Machine_epsilon">machine epsilon</a>, or perhaps <span class="math inline">\(\varepsilon\)</span>.</li>
<li>The difference between 1.0 and the next available floating point number.</li>
<li>Much lower, of course, with double and quad precision.</li>
</ul>
</section>
<section id="easier-sig-figs" class="slide level2">
<h2>Easier: “Sig figs”</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Format</th>
<th style="text-align: center;">Sign</th>
<th style="text-align: center;">Exp.</th>
<th style="text-align: center;">Mant.</th>
<th style="text-align: center;">Bits</th>
<th style="text-align: center;">Bias</th>
<th style="text-align: center;">Prec.</th>
<th style="text-align: center;">Significance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Half</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;"><strong>3-4</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Single</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">127</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;"><strong>6-9</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Double</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">52</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">1023</td>
<td style="text-align: center;">53</td>
<td style="text-align: center;"><strong>15-17</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Quad</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">112</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">16383</td>
<td style="text-align: center;">113</td>
<td style="text-align: center;"><strong>33-36</strong></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="https://people.eecs.berkeley.edu/~wkahan/ieee754status/IEEE754.PDF">Prof.&nbsp;Kahan, UCB EECS</a></li>
</ul>
</section>
<section id="sig-figs" class="slide level2">
<h2>Sig figs</h2>
<ul>
<li>IEEE 754 was intended for <em>scientific computing</em></li>
<li>That is, not systems computing, software etc.</li>
<li>Useful to us to think about information and how bits work.</li>
</ul>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/Significant_figures">Significant figures, also referred to as significant digits, are specific digits within a number that is written in positional notation that carry both reliability and necessity in conveying a particular quantity.</a></p>
</blockquote>
</section>
<section id="small-values" class="slide level2">
<h2>Small Values</h2>
<ul>
<li>For 32-bit floats, the minimum base 10 exponent is -36.</li>
<li>How is <span class="math inline">\(1.0 \times 10^{-37}\)</span> represented?</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource rs number-lines code-with-copy"><code class="sourceCode rust"><span id="cb13-1"><a></a><span class="co">// In Rust, we may use '0b' prefix for binary representation.</span></span>
<span id="cb13-2"><a></a><span class="co">// In Rust, we may us underscores within numerical values.</span></span>
<span id="cb13-3"><a></a><span class="dv">0b0_00000000_11011001110001111101110</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="test-it" class="slide level2">
<h2>Test it</h2>
<ul>
<li>Write a simple test…</li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>src/main.rs</strong></pre>
</div>
<div class="sourceCode" id="cb14" data-filename="src/main.rs"><pre class="sourceCode numberSource rs number-lines code-with-copy"><code class="sourceCode rust"><span id="cb14-1"><a></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb14-2"><a></a>    <span class="kw">let</span> b<span class="op">:</span><span class="dt">u32</span> <span class="op">=</span> <span class="dv">0b0_00000000_11011001110001111101110</span><span class="op">;</span></span>
<span id="cb14-3"><a></a>    <span class="pp">println!</span>(<span class="st">"{:032b}"</span><span class="op">,</span> b)<span class="op">;</span></span>
<span id="cb14-4"><a></a>    <span class="pp">println!</span>(<span class="st">"{:1.100}"</span><span class="op">,</span> <span class="dt">f32</span><span class="pp">::</span>from_bits(b))<span class="op">;</span></span>
<span id="cb14-5"><a></a>    <span class="kw">let</span> x<span class="op">:</span><span class="dt">f32</span> <span class="op">=</span> <span class="dv">10.0_f32</span><span class="op">.</span>powf(<span class="op">-</span><span class="dv">38.0_f32</span>)<span class="op">;</span></span>
<span id="cb14-6"><a></a>    <span class="pp">println!</span>(<span class="st">"{:032b}"</span><span class="op">,</span> x<span class="op">.</span>to_bits())<span class="op">;</span></span>
<span id="cb14-7"><a></a>    <span class="pp">println!</span>(<span class="st">"{:1.100}"</span><span class="op">,</span> x)<span class="op">;</span></span>
<span id="cb14-8"><a></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Results are as expected.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource sh number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a></a><span class="ex">00000000011011001110001111101110</span></span>
<span id="cb15-2"><a></a><span class="ex">0.0000000000000000000000000000000000000099999993504564039245746141539976645128551939195729831580121175</span></span>
<span id="cb15-3"><a></a><span class="ex">00000000011011001110001111101110</span></span>
<span id="cb15-4"><a></a><span class="ex">0.0000000000000000000000000000000000000099999993504564039245746141539976645128551939195729831580121175</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="denormalized-number" class="slide level2">
<h2>“Denormalized Number”</h2>
<ul>
<li>Numbers that have a zero exponent</li>
<li>Required when the exponent is below the minimum exponent</li>
<li>Helps prevent underflow</li>
<li>Generally speaking, if you are using one these, the math is about to get wronger than you’d think.</li>
<li>The good (???) language C++ provides a <code>std::nextafter</code> for which Rust crates exist.</li>
</ul>
</section>
<section id="floating-point-precision" class="slide level2">
<h2>Floating Point Precision</h2>
<ul>
<li>Representation is not uniform between numbers</li>
<li>Most precision lies between 0.0 and 0.1</li>
<li>Precision falls away</li>
</ul>
</section>
<section id="visually" class="slide level2">
<h2>Visually</h2>

<img data-src="https://dwayneneed.github.io/static/img/2010-05-06-fun-with-floating-point_6bit-float-distribution.png" class="r-stretch"><ul>
<li><a href="https://dwayneneed.github.io/.net/2010/05/06/fun-with-floating-point.html">Fun with floating point, Dwayne Need</a></li>
</ul>
</section>
<section id="floating-point-precision-1" class="slide level2">
<h2>Floating Point Precision</h2>
<p>The number of floats from 0.0</p>
<ul>
<li>… to 0.1 = 1,036,831,949</li>
<li>… to 0.2 = 8,388,608</li>
<li>… to 0.4 = 8,388,608</li>
<li>… to 0.8 = 8,388,608</li>
<li>… to 1.6 = 8,388,608</li>
<li>… to 3.2 = 8,388,608</li>
</ul>
</section>
<section id="errors-in-floating-point" class="slide level2">
<h2>Errors in Floating Point</h2>
<ul>
<li>Storage of <span class="math inline">\(\pi\)</span></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> numpy <span class="im">import</span> pi <span class="im">as</span> pi</span>
<span id="cb16-2"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="co"># copy paste Wolfram|Alpha</span></span>
<span id="cb16-3"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="st">'3.14159265358979323846264338327950288419716939937510582097494459230781640628'</span></span>
<span id="cb16-4"><a></a><span class="co">'3.14159265358979323846264338327950288419716939937510582097494459230781640628'</span></span>
<span id="cb16-5"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="ss">f'</span><span class="sc">{</span>pi<span class="sc">:1.100}</span><span class="ss">'</span></span>
<span id="cb16-6"><a></a><span class="co">'3.141592653589793115997963468544185161590576171875'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>They differ fairly early on!</li>
</ul>
</section>
<section id="measuring-error-ulps" class="slide level2">
<h2>Measuring Error: “Ulps”</h2>
<ul>
<li>Units in Last Place</li>
</ul>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/Unit_in_the_last_place">In computer science and numerical analysis, unit in the last place or unit of least precision (ulp) is the spacing between two consecutive floating-point numbers, i.e., the value the least significant digit (rightmost digit) represents if it is 1. It is used as a measure of accuracy in numeric calculations.</a></p>
</blockquote>
</section>
<section id="generators" class="slide level2">
<h2>Generators</h2>
<ul>
<li>By convention we check number theoretic results with lazily evaluated generator expressions in Python.</li>
<li>The following generators all powers of two for a which adding one does not change the value within Python floating points.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a><span class="im">from</span> itertools <span class="im">import</span> count</span>
<span id="cb17-2"><a></a></span>
<span id="cb17-3"><a></a>gen <span class="op">=</span> (i <span class="cf">for</span> i <span class="kw">in</span> count() <span class="cf">if</span> <span class="fl">2.0</span> <span class="op">**</span> <span class="bu">float</span>(i) <span class="op">+</span> <span class="fl">1.0</span> <span class="op">==</span> <span class="fl">2.0</span> <span class="op">**</span> <span class="bu">float</span>(i))</span>
<span id="cb17-4"><a></a></span>
<span id="cb17-5"><a></a>x <span class="op">=</span> <span class="bu">next</span>(gen)</span>
<span id="cb17-6"><a></a></span>
<span id="cb17-7"><a></a><span class="bu">print</span>(<span class="st">'2.0 ** x + 0.0 = '</span>, <span class="fl">2.0</span> <span class="op">**</span> x <span class="op">+</span> <span class="fl">0.0</span>)</span>
<span id="cb17-8"><a></a><span class="bu">print</span>(<span class="st">'2.0 ** x + 1.0 = '</span>, <span class="fl">2.0</span> <span class="op">**</span> x <span class="op">+</span> <span class="fl">1.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="iterators" class="slide level2">
<h2>Iterators</h2>
<ul>
<li>Rust doesn’t require iterators, supporting the infinite iterator by default using <code>unwrap</code>.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource rs number-lines code-with-copy"><code class="sourceCode rust"><span id="cb18-1"><a></a><span class="kw">let</span> x <span class="op">=</span> (<span class="dv">0</span><span class="op">..</span>)<span class="op">.</span>find(<span class="op">|&amp;</span>i<span class="op">|</span> <span class="dt">f64</span><span class="pp">::</span>powi(<span class="dv">2.0</span><span class="op">,</span> i) <span class="op">+</span> <span class="dv">1.0</span> <span class="op">==</span> <span class="dt">f64</span><span class="pp">::</span>powi(<span class="dv">2.0</span><span class="op">,</span> i))<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb18-2"><a></a></span>
<span id="cb18-3"><a></a><span class="kw">let</span> base <span class="op">=</span> <span class="dt">f64</span><span class="pp">::</span>powi(<span class="dv">2.0</span><span class="op">,</span> x)<span class="op">;</span></span>
<span id="cb18-4"><a></a></span>
<span id="cb18-5"><a></a><span class="co">// Prints the result (2^53 = 9007199254740992.0)</span></span>
<span id="cb18-6"><a></a><span class="pp">println!</span>(<span class="st">"2.0 ** x + 0.0 = {:.1}"</span><span class="op">,</span> base)<span class="op">;</span></span>
<span id="cb18-7"><a></a><span class="pp">println!</span>(<span class="st">"2.0 ** x + 1.0 = {:.1}"</span><span class="op">,</span> base <span class="op">+</span> <span class="dv">1.0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>I haven’t used <code>find</code> before, this is an LLM donation to our knowledge base.</li>
<li>By the way, that is basically <code>2 ** 53</code> and there are 52 bits of mantissa precision.</li>
</ul>
</section>
<section id="on-ulps" class="slide level2">
<h2>On “Ulps”</h2>
<ul>
<li>We can measure error using ULPs.</li>
</ul>
<blockquote>
<p><a href="https://www.cs.berkeley.edu/~wkahan/LOG10HAF.TXT">The gap between the two floating-point numbers nearest to x, even if x is one of )them.</a></p>
</blockquote>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> numpy <span class="im">import</span> float32 <span class="im">as</span> f32, pi <span class="im">as</span> pi, float64 <span class="im">as</span> f64</span>
<span id="cb19-2"><a></a><span class="op">&gt;&gt;&gt;</span> f64(pi) <span class="op">-</span> f64(f32(pi))</span>
<span id="cb19-3"><a></a>np.float64(<span class="op">-</span><span class="fl">8.742278012618954e-08</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="rounding" class="slide level2">
<h2>Rounding</h2>
<ul>
<li>We have some guarantees:
<ul>
<li>IEEE 754 requires that that elementary arithmetic operations are correctly rounded to within 0.5 ulps</li>
<li>Transcendental functions are generally rounded to between 0.5 and 1.0 ulps
<ul>
<li>Transcendental as in <span class="math inline">\(\pi\)</span> or <span class="math inline">\(e\)</span></li>
</ul></li>
</ul></li>
<li>~9 ulps</li>
</ul>
</section>
<section>
<section id="relative-error" class="title-slide slide level1 center">
<h1>Relative Error</h1>
<ul>
<li>The difference between the “real” number and the approximated number, divided by the “real” number.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a><span class="op">&gt;&gt;&gt;</span> f64(f32(pi))<span class="op">/</span>f64(pi)</span>
<span id="cb20-2"><a></a>np.float64(<span class="fl">1.0000000278275352</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>So for <code>pi</code> in <code>f32</code>, around <span class="math inline">\(2.9 \times 10^{-8}\)</span></li>
</ul>
</section>
<section id="rounding-error" class="slide level2">
<h2>Rounding Error</h2>
<ul>
<li>Induced by approximating an infinite range of numbers into a finite number of bits</li>
<li>Rounding is:
<ul>
<li>Towards the nearest</li>
<li>Towards zero</li>
<li>Towards positive infinity (round up)</li>
<li>Towards negative infinity (round down)</li>
</ul></li>
</ul>
</section>
<section id="rounding-error-1" class="slide level2">
<h2>Rounding Error</h2>
<ul>
<li>What about rounding the half-way case? (i.e.&nbsp;0.5)
<ul>
<li>Round Up vs.&nbsp;Round Even</li>
</ul></li>
<li>Correct Rounding:
<ul>
<li>Basic operations (add, subtract, multiply, divide, sqrt) should return the number nearest the mathematical result.</li>
<li>If there is a tie, round to the number with an even mantissa</li>
</ul></li>
</ul>
</section>
<section id="implementation" class="slide level2">
<h2>Implementation</h2>
<ul>
<li>“Guard Bit”, “Round Bit”, “Sticky Bit”</li>
<li>Only used while doing calculations
<ul>
<li>Not stored in the float itself</li>
<li>The mantissa is shifted in calculations to align radix</li>
</ul></li>
<li>The guard bits and round bits are extra precision</li>
<li>The sticky bit is an OR of anything that shifts through it</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource rs number-lines code-with-copy"><code class="sourceCode rust"><span id="cb21-1"><a></a>0_00000000_00000000000000000000000_G_R_S<span class="op">..</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="special-bits" class="slide level2">
<h2>Special bits</h2>
<ul>
<li>“Guard Bit”, “Round Bit”, “Sticky Bit”</li>
<li><strong>[G][R][S]</strong></li>
<li><strong>[0][-][-]</strong> - Round Down (do nothing)</li>
<li><strong>[1][0][0]</strong> - Round Up if the mantissa LSB is 1</li>
<li><strong>[1][0][1]</strong> - Round Up</li>
<li><strong>[1][1][0]</strong> - Round Up</li>
<li><strong>[1][1][1]</strong> - Round Up</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource rs number-lines code-with-copy"><code class="sourceCode rust"><span id="cb22-1"><a></a>0_00000000_00000000000000000000000_G_R_S<span class="op">..</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="significance-error" class="slide level2">
<h2>Significance Error</h2>
<ul>
<li>Compute the Area of a Triangle
<ul>
<li>Heron’s Formula:
<ul>
<li>𝐴 = 𝑥+𝑦 2 +𝑍 𝑥+𝑦 2 +𝑍 −𝑥 𝑥+𝑦 2 +𝑍 −𝑦 𝑥+𝑦 2 +𝑍 −𝑧</li>
</ul></li>
<li>Kahan’sAlgorithm:
<ul>
<li>Sort x, y, z such that 𝑥≥𝑦 ≥𝑧</li>
<li>If 𝑧&lt; 𝑥−𝑦, then no such triangle exists.</li>
<li>Else 𝐴 = (𝑥+𝑦+𝑧) × 𝑧−(𝑥−𝑦 )× 4 (𝑧+𝑥−𝑦 )×(𝑥+𝑦−𝑧)</li>
</ul></li>
</ul></li>
</ul>
<p>Significance Error</p>
<pre><code>/// Area of a triangle
/// From http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html
/// From https://www.cs.berkeley.edu/~wkahan/Triangle.pdf
TEST(CPPCon2015, AreaOfATriangleFloat)
{
const auto a = 100000.0f;
const auto b = 99999.99979f;
const auto c = 0.00029f;</code></pre>
<pre><code>ASSERT_TRUE(a &gt;= b);
ASSERT_TRUE(b &gt;= c);</code></pre>
<pre><code>auto heronsFormula = HeronsFormula(a, b, c);
auto kahansFormula = KahansFormula(a, b, c);
EXPECT_NE(kahansFormula, heronsFormula);
cppCon() &lt;&lt; "Kahan: " &lt;&lt; kahansFormula;
cppCon() &lt;&lt; "Heron: " &lt;&lt; heronsFormula;
cppCon() &lt;&lt; "delta: " &lt;&lt; kahansFormula - heronsFormula &lt;&lt; "\n";
}</code></pre>
<p>Significance Error</p>
<p>Heron: 0.000000000000000000000000000000</p>
<p>Kahan: 14.500000000000000000000000000000</p>
<p>delta: 14.500000000000000000000000000000</p>
<p>Significance Error</p>
<p>Heron: 0.000000000000000000000000000000</p>
<p>Kahan: 14.500000000000000000000000000000</p>
<p>delta: 14.500000000000000000000000000000</p>
<p>Hint: The Answer is 10.0</p>
<p>Significance Error</p>
<p>Heron: 0.000000000000000000000000000000</p>
<p>Kahan: 14.500000000000000000000000000000</p>
<p>delta: 14.500000000000000000000000000000</p>
<p>Heron: 9.999999809638328700000000000000</p>
<p>Kahan: 10.000000077021038000000000000000</p>
<p>delta: 0.000000267382709751018410000000</p>
<p>Significance Error - Use Stable Algorithms</p>
<ul>
<li>Loss of Significance
<ul>
<li>Keep big numbers with big numbers, little numbers with little numbers.</li>
</ul></li>
<li>Parentheses can help</li>
<li>Analysis of Algorithms is Critical</li>
<li>The compiler won’t re-arrange your math if it cannot prove it would yield the same</li>
</ul>
<p>result, even if the computation would be faster</p>
<ul>
<li>𝑥 = 𝑏− 𝑎+𝑏 −𝑎 should not be replaced with 𝑥= 0</li>
<li>See the “Kahan’sAlgorithm” example</li>
</ul>
<p>Significance Error – Simulation Time</p>
<ul>
<li>Time is used to compute distance, velocity, acceleration
<ul>
<li>High frequency phenomena</li>
<li>Sensors: Doppler shift, pulse compression, PRF</li>
</ul></li>
<li>These computed values feed into other computed values which may or may not</li>
</ul>
<p>require a time component</p>
<ul>
<li>Thousands of computations per frame of simulation
<ul>
<li>Thousands of little compounding errors per frame</li>
</ul></li>
<li>Combine with poor or nonexistent testing</li>
</ul>
<p>Significance Error – Simulation Time</p>
<ul>
<li>Accumulate Time (works for arbitrary</li>
</ul>
<p>time steps)</p>
<p>auto totalFrames = size_t(0); auto frameLength = 0.01f; auto simTime = 0.0f;</p>
<p>// Run 120 Frames auto simTime120Frames = 1.20f; for(; totalFrames &lt; 120; totalFrames++) { simTime += frameLength; }</p>
<pre><code>auto totalFrames = size_t(0);
auto frameLength = 0.01f;
auto simTime = 0.0f;</code></pre>
<pre><code>// Run 120 Frames
auto simTime120Frames = 1.20f;
totalFrames = 120;
simTime = totalFrames * frameLength;</code></pre>
<ul>
<li>Delta Time (works for fixed time steps)</li>
</ul>
<p>Significance Error – Simulation Time</p>
<p>Accumulate Time (works for arbitrary time steps)</p>
<ul>
<li>1.199999999999999955591079014994 != <strong>1.199999213218688964843750000000</strong> (0.000000786781310990747329014994)</li>
<li>12.000000000000000000000000000000 != <strong>12.000179290771484375000000000000</strong> (- 0.000179290771484375000000000000)</li>
<li>120.000000000000000000000000000000 != <strong>120.007225036621093750000000000000</strong> (- 0.007225036621093750000000000000)</li>
<li>600.000000000000000000000000000000 != <strong>600.274414062500000000000000000000</strong> (- 0.274414062500000000000000000000)</li>
<li>3600.000000000000000000000000000000 != <strong>3603.204101562500000000000000000000</strong> (- 3.204101562500000000000000000000)</li>
</ul>
<p>Delta Time (works for fixed time steps)</p>
<ul>
<li>1.200000047683715820312500000000 != <strong>1.199999928474426269531250000000</strong> (0.000000119209289550781250000000)</li>
<li>12.000000000000000000000000000000 == <strong>12.000000000000000000000000000000</strong> (0.000000000000000000000000000000)</li>
<li>120.000000000000000000000000000000 == <strong>120.000000000000000000000000000000</strong> (0.000000000000000000000000000000)</li>
<li>600.000000000000000000000000000000 == <strong>600.000000000000000000000000000000</strong> (0.000000000000000000000000000000)</li>
<li>-3600.000000000000000000000000000000 == <strong>3600.000000000000000000000000000000</strong> (0.000000000000000000000000000000)</li>
</ul>
<p>Significance Error – Simulation Time</p>
<ul>
<li>“Sub-Microsecond Precision”
<ul>
<li>1.2345e-6 seconds per frame (810044.5 Hz)</li>
</ul></li>
</ul>
<p>Significance Error – Simulation Time</p>
<ul>
<li>“Sub-Microsecond Precision”
<ul>
<li>1.2345e-6 seconds per frame (810044.5 Hz)</li>
</ul></li>
</ul>
<h3 id="section">0.012345000170171261000000000000 !=</h3>
<h3 id="section-1">0.0148140005767345430</h3>
<h3 id="section-2">(-0.002469000406563282000000000000)</h3>
<h3 id="section-3">12.345000267028809000000000000000 !=</h3>
<h3 id="section-4">11.701118469238281000000000000000</h3>
<h3 id="section-5">(0.643881797790527340000000000000)</h3>
<p>Significance Error – Don’t use IEEE Floats?</p>
<ul>
<li>Use integers
<ul>
<li>Very fast</li>
<li>Trade more precision for less range</li>
<li>Only input/output may be impacted by floating point conversions</li>
<li>Financial applications represent dollars as only cents or tenth’s of cents</li>
</ul></li>
<li>Use a math library
<ul>
<li>Slower</li>
<li>Define your own level of accuracy</li>
<li>MPFR (w/C++ Wrapper), TTMath, Boost, GMP C++</li>
<li>CRlibm(Correctly Rounded Mathematical Library)</li>
</ul></li>
</ul>
<p>(Store simTimeas uint64_tand get microsecond precision for 584555 years.)</p>
<p>Algebraic Assumption Error</p>
<ul>
<li>Mathematical Identities
<ul>
<li>Traditional identities (associative, commutative, distributive) do not hold</li>
</ul></li>
<li>Distributive Rule does not apply: 𝑥 ×𝑦 −𝑥 × 𝑧 ≠ 𝑥 (𝑦 −𝑧)</li>
<li>Associative Rule does not apply: 𝑥 + 𝑦 +𝑧 ≠ 𝑥 +𝑦 +𝑧</li>
<li>Cannot interchange division and multiplication:</li>
</ul>
<h3 id="𝑥">𝑥</h3>
<h3 id="section-6">10. 0</h3>
<p>≠ 𝑥 × 0. 1</p>
<p>Does a naïve compiler make these assumptions too?</p>
<p>https://msdn.microsoft.com/library/aa289157.aspx</p>
<p>Algebraic Assumption Error</p>
<pre><code>const auto oneRadian = 0.15915494309f;
const auto control = 0.000000000015915494309f;</code></pre>
<pre><code>const auto oneRadianMultiplied = oneRadian * 1.0e-10f;
const auto oneRadianDivided = oneRadian / 1.0e10f;</code></pre>
<p>Algebraic Assumption Error</p>
<pre><code>const auto oneRadian = 0.15915494309f;
const auto control = 0.000000000015915494309f;</code></pre>
<pre><code>const auto oneRadianMultiplied = oneRadian * 1.0e-10f;
const auto oneRadianDivided = oneRadian / 1.0e10f;</code></pre>
<p>Control: 0.000000000015915494616658421000 x*1.0e-10f: 0.000000000015915494616658421000(0.000000000000000000000000000000) x/1.0e10f: 0.00000000001591549 2881934945000 (0.000000000000000001734723475977) Relative Error: 0.000000108995891423546710000000</p>
<p>Floating Point Exceptions</p>
<ul>
<li>Enable floating point exceptions to be alerted when things go awry.</li>
</ul>
<pre><code>𝑥is the exact result of the operation
α= 192 for single precision, 1536 for double
𝑥𝑚𝑎𝑥= 1. 111 ... 111 × 2 𝑒𝑚𝑖𝑛.
See &lt;cfenv&gt; -Floating Point Environment</code></pre>
<p>IEEE 754 Exception Result when traps disabled Argument to trap handler</p>
<p>overflow ±∞ or ±𝑥𝑚𝑎𝑥 round(𝑥 2 −𝛼)</p>
<p>underflow 0, 2 𝑒𝑚𝑖𝑛or denormalized round(𝑥 2 𝛼)</p>
<p>divide by zero ±∞ invalid operation</p>
<p>invalid NaN invalid operation</p>
<p>inexact round( <em>x</em> ) round( <em>x</em> )</p>
<p>But Wait! There’s More!</p>
<ul>
<li>Binary to Decimal Conversion Error</li>
<li>Summation Error</li>
<li>Propagation Error</li>
<li>Underflow, Overflow</li>
<li>Type Narrowing/Widening Rules</li>
</ul>
<p>Miscellaneous Notes</p>
<p><a href="http://preshing.com/images/float-point-perf.png">http://preshing.com/images/float-point-perf.png</a> https://github.com/DigitalInBlue/CPPCon2015</p>
<p>Use Your Compiler’s Output</p>
<ul>
<li>warning C4244: ‘initializing’ : conversion from ‘double’ to</li>
</ul>
<p>‘float’, possible loss of data</p>
<ul>
<li>warning C4056: overflow in floating point constant arithmetic</li>
<li>warning C4305: ‘identifier’ : truncation from ‘type1’ to</li>
</ul>
<p>‘type2’</p>
<ul>
<li>warning: conversion to ‘float’ from ‘int’ may alter its value</li>
<li>warning: floating constant exceeds range of ‘double’</li>
</ul>
<p>Fused Multiply-Add (FMA)</p>
<ul>
<li>a = a + (b * c); a += b * c;</li>
<li>Multiplier-accumulator (MAC Unit)</li>
<li>One rounding</li>
<li>Compiler Options
<ul>
<li>GCC = -mfma</li>
<li>VC++ = #pragma fp_contract (off)</li>
</ul></li>
<li>Reference: FMA3, FMA4
<ul>
<li><a href="http://en.wikipedia.org/wiki/FMA_instruction_set">http://en.wikipedia.org/wiki/FMA_instruction_set</a></li>
</ul></li>
</ul>
<p>Streaming SIMD Extensions (SSE)</p>
<ul>
<li>SSE can provide significant performance gains
<ul>
<li>Supports integer, floating point, logical, conversion, shift, and shuffle operations</li>
</ul></li>
<li>C, C++, Fortran do not natively support SSE, but compiler-specific support exists</li>
</ul>
<p>Float Tricks</p>
<pre><code>/// Fast reciprocal square root approximation for x &gt; 0.25
/// Quake’s float Q_rsqrt(float number) is much more entertaining.
inline float FastInvSqrt(float x)
{
int tmp = ((0x3f800000 &lt;&lt; 1) + 0x3f800000 - *(long*)&amp;x) &gt;&gt; 1;
auto y = *(float*)&amp;tmp;
return y * (1.47f – 0.47f * x * y * y);
}</code></pre>
<p>Testing</p>
<ul>
<li>Design for Numerical Stability</li>
<li>Perform Meaningful Testing</li>
<li>Document assumptions</li>
<li>Track sources of approximation</li>
<li>Quantify goodness
<ul>
<li>Well conditioned algorithms</li>
</ul></li>
<li>Backward error analysis
<ul>
<li>Are the outputs identical for slightly modified inputs?</li>
</ul></li>
</ul>
<pre><code>TEST(CPPCon2015, pointOnePlusPointTwo)
{
auto zeroPointOne = 0.1f;
auto zeroPointTwo = 0.2f;
auto zeroPointThree = 0.3f;
auto sum = zeroPointOne + zeroPointTwo;</code></pre>
<pre><code>EXPECT_DOUBLE_EQ(0.3f, zeroPointThree);
EXPECT_EQ(0.3f, zeroPointThree);
EXPECT_EQ(0.3f, sum);</code></pre>
<pre><code>EXPECT_EQ(zeroPointThree, sum);
EXPECT_DOUBLE_EQ(zeroPointThree, sum);
}</code></pre>
<p><a href="http://xkcd.com/217/">http://xkcd.com/217/</a> <a href="http://www.explainxkcd.com/wiki/index.php/217:_e_to_the_pi_Minus_pi">http://www.explainxkcd.com/wiki/index.php/217:_e_to_the_pi_Minus_pi</a></p>
<pre><code>https://github.com/DigitalInBlue/CPPCon2015</code></pre>
</section></section>
<section id="demystifying-floating-point" class="title-slide slide level1 center">
<h1>Demystifying Floating Point</h1>
<p>John Farrier, Booz Allen Hamilton</p>
<pre><code>https://github.com/DigitalInBlue/CPPCon2015</code></pre>


</section>


    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="index.html">Home</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>