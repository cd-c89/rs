<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EdDSA – Systems in Rust</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./81_python.html" rel="next">
<link href="./72_ix.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a4a11d514c7d463668e07712114998e6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70c9a4798e5f6abb0636bcdc3eed0e90.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./80_eddsa.html">EdDSA</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Systems in Rust</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_rustup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rustup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_hiworld.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hi world</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_hicargo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hi cargo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_options.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Options</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_guess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guess</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_wordle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wordle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30_bits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bits</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31_hamming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hamming</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32_macros.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Macros</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./40_sha2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SHA-2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./41_constants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constants</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./42_sha512.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SHA-512</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./50_754.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IEEE 754</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./51_f16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">f16</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./70_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numbers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./71_ix_io.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical I/O</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./72_ix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./80_eddsa.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">EdDSA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./81_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./82_ed25519.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ed25519</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./90_stack.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stack</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./91_box.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./92_traits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Traits</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A0_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A1_dag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DAG</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A2_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B0_dynamic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamism</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B2_lcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LCS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C0_merkle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Merkle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C1_heap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heap</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C2_diff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">diff</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./D0_serde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Serde</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./E0_scm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SCM</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#announcements" id="toc-announcements" class="nav-link active" data-scroll-target="#announcements">Announcements</a>
  <ul class="collapse">
  <li><a href="#today" id="toc-today" class="nav-link" data-scroll-target="#today">Today</a></li>
  </ul></li>
  <li><a href="#public-key-cryptography" id="toc-public-key-cryptography" class="nav-link" data-scroll-target="#public-key-cryptography">Public Key Cryptography</a>
  <ul class="collapse">
  <li><a href="#motivating-example" id="toc-motivating-example" class="nav-link" data-scroll-target="#motivating-example">Motivating Example</a></li>
  <li><a href="#reads-cryptobook" id="toc-reads-cryptobook" class="nav-link" data-scroll-target="#reads-cryptobook">Reads Cryptobook</a></li>
  <li><a href="#reads-cryptobook-1" id="toc-reads-cryptobook-1" class="nav-link" data-scroll-target="#reads-cryptobook-1">Reads Cryptobook</a></li>
  <li><a href="#set-the-stage" id="toc-set-the-stage" class="nav-link" data-scroll-target="#set-the-stage">Set the Stage</a></li>
  <li><a href="#first-contact" id="toc-first-contact" class="nav-link" data-scroll-target="#first-contact">First Contact</a></li>
  <li><a href="#initialization" id="toc-initialization" class="nav-link" data-scroll-target="#initialization">Initialization</a></li>
  <li><a href="#securedrop" id="toc-securedrop" class="nav-link" data-scroll-target="#securedrop">SecureDrop</a></li>
  <li><a href="#safety-note" id="toc-safety-note" class="nav-link" data-scroll-target="#safety-note">Safety Note</a></li>
  <li><a href="#step-2" id="toc-step-2" class="nav-link" data-scroll-target="#step-2">Step 2</a></li>
  <li><a href="#step-3" id="toc-step-3" class="nav-link" data-scroll-target="#step-3">Step 3</a></li>
  <li><a href="#its-that-simple" id="toc-its-that-simple" class="nav-link" data-scroll-target="#its-that-simple">It’s that simple</a></li>
  </ul></li>
  <li><a href="#digital-signatures" id="toc-digital-signatures" class="nav-link" data-scroll-target="#digital-signatures">Digital Signatures</a>
  <ul class="collapse">
  <li><a href="#motivating-example-1" id="toc-motivating-example-1" class="nav-link" data-scroll-target="#motivating-example-1">Motivating Example</a></li>
  <li><a href="#a-transaction" id="toc-a-transaction" class="nav-link" data-scroll-target="#a-transaction">A transaction</a></li>
  <li><a href="#signage" id="toc-signage" class="nav-link" data-scroll-target="#signage">Signage</a></li>
  <li><a href="#verify" id="toc-verify" class="nav-link" data-scroll-target="#verify">Verify</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  <li><a href="#eddsa-algorithm" id="toc-eddsa-algorithm" class="nav-link" data-scroll-target="#eddsa-algorithm">EdDSA, algorithm</a>
  <ul class="collapse">
  <li><a href="#eddsa" id="toc-eddsa" class="nav-link" data-scroll-target="#eddsa">EdDSA</a></li>
  <li><a href="#iterative-definition" id="toc-iterative-definition" class="nav-link" data-scroll-target="#iterative-definition">Iterative Definition</a></li>
  <li><a href="#iterative-definition-1" id="toc-iterative-definition-1" class="nav-link" data-scroll-target="#iterative-definition-1">Iterative Definition</a></li>
  <li><a href="#galois-field" id="toc-galois-field" class="nav-link" data-scroll-target="#galois-field">Galois field</a></li>
  <li><a href="#recall" id="toc-recall" class="nav-link" data-scroll-target="#recall">Recall</a></li>
  <li><a href="#iterative-definition-2" id="toc-iterative-definition-2" class="nav-link" data-scroll-target="#iterative-definition-2">Iterative Definition</a></li>
  <li><a href="#plane-curve" id="toc-plane-curve" class="nav-link" data-scroll-target="#plane-curve">Plane Curve</a></li>
  <li><a href="#graphs-of-continous-functions" id="toc-graphs-of-continous-functions" class="nav-link" data-scroll-target="#graphs-of-continous-functions">Graphs of Continous Functions</a></li>
  <li><a href="#iterative-definition-3" id="toc-iterative-definition-3" class="nav-link" data-scroll-target="#iterative-definition-3">Iterative Definition</a></li>
  <li><a href="#iterative-definition-4" id="toc-iterative-definition-4" class="nav-link" data-scroll-target="#iterative-definition-4">Iterative Definition</a></li>
  <li><a href="#iterative-definition-5" id="toc-iterative-definition-5" class="nav-link" data-scroll-target="#iterative-definition-5">Iterative Definition</a></li>
  </ul></li>
  <li><a href="#eddsa-terms" id="toc-eddsa-terms" class="nav-link" data-scroll-target="#eddsa-terms">EdDSA, terms</a>
  <ul class="collapse">
  <li><a href="#public-key" id="toc-public-key" class="nav-link" data-scroll-target="#public-key">Public key</a></li>
  <li><a href="#signature-verification" id="toc-signature-verification" class="nav-link" data-scroll-target="#signature-verification">Signature verification</a></li>
  <li><a href="#private-key" id="toc-private-key" class="nav-link" data-scroll-target="#private-key">Private key</a></li>
  <li><a href="#signing" id="toc-signing" class="nav-link" data-scroll-target="#signing">Signing</a></li>
  </ul></li>
  <li><a href="#eddsa-ed25519" id="toc-eddsa-ed25519" class="nav-link" data-scroll-target="#eddsa-ed25519">EdDSA, Ed25519</a>
  <ul class="collapse">
  <li><a href="#ed25519" id="toc-ed25519" class="nav-link" data-scroll-target="#ed25519">Ed25519</a></li>
  <li><a href="#curve25519" id="toc-curve25519" class="nav-link" data-scroll-target="#curve25519">Curve25519</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#bernstein" id="toc-bernstein" class="nav-link" data-scroll-target="#bernstein">Bernstein</a></li>
  <li><a href="#lange" id="toc-lange" class="nav-link" data-scroll-target="#lange">Lange</a></li>
  <li><a href="#p" id="toc-p" class="nav-link" data-scroll-target="#p"><span class="math inline">\(p\)</span></a></li>
  <li><a href="#emathbbf_2255-19" id="toc-emathbbf_2255-19" class="nav-link" data-scroll-target="#emathbbf_2255-19"><span class="math inline">\(E/\mathbb{F}_{2^{255}-19}\)</span></a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#ed25519-1" id="toc-ed25519-1" class="nav-link" data-scroll-target="#ed25519-1">Ed25519</a></li>
  <li><a href="#ed25519-2" id="toc-ed25519-2" class="nav-link" data-scroll-target="#ed25519-2">Ed25519</a></li>
  <li><a href="#ed25519-3" id="toc-ed25519-3" class="nav-link" data-scroll-target="#ed25519-3">Ed25519</a></li>
  <li><a href="#ed25519-4" id="toc-ed25519-4" class="nav-link" data-scroll-target="#ed25519-4">Ed25519</a></li>
  <li><a href="#ed25519-definitions" id="toc-ed25519-definitions" class="nav-link" data-scroll-target="#ed25519-definitions">Ed25519, definitions</a></li>
  </ul></li>
  <li><a href="#ed25519-takeaways" id="toc-ed25519-takeaways" class="nav-link" data-scroll-target="#ed25519-takeaways">Ed25519, Takeaways</a>
  <ul class="collapse">
  <li><a href="#learn-more" id="toc-learn-more" class="nav-link" data-scroll-target="#learn-more">Learn More</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="80_eddsa.rjs.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">EdDSA</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
<p class="subtitle lead">Systems in Rust</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="announcements" class="level1">
<h1>Announcements</h1>
<ul>
<li><strong>Welcome</strong> to Systems in Rust</li>
<li><strong>Action Items</strong>:
<ul>
<li>Midterms verbal update.</li>
<li>Keep at <code>ix</code></li>
<li>This unlocks the last and greatest of the cryptographic homeworks so we can get to graph theory.</li>
</ul></li>
</ul>
<section id="today" class="level2">
<h2 class="anchored" data-anchor-id="today">Today</h2>
<ul>
<li>Private Key Cryptography</li>
<li>Digital Signatures</li>
<li>Edwards-curve Digital Signature Algorithm (EdDSA)
<ul>
<li>Some math where we need it</li>
<li>An aside on side channels if we get bored</li>
</ul></li>
</ul>
</section>
</section>
<section id="public-key-cryptography" class="level1">
<h1>Public Key Cryptography</h1>
<section id="motivating-example" class="level2">
<h2 class="anchored" data-anchor-id="motivating-example">Motivating Example</h2>
<ul>
<li>Canonical Example is Snowden x Greenwald 2013
<ul>
<li>Snowden wished to communicate a secret to Greenwald</li>
<li>Snowden and Greenwald had never met</li>
<li>Snowden could not transmit the secret in plain text</li>
</ul></li>
<li>Vs enigma, no prior agreement on how to encrypt/decrypt</li>
</ul>
</section>
<section id="reads-cryptobook" class="level2">
<h2 class="anchored" data-anchor-id="reads-cryptobook">Reads <a href="https://toc.cryptobook.us/book.pdf">Cryptobook</a></h2>
<blockquote class="blockquote">
<p>A key exchange protocol <span class="math inline">\(P\)</span> is a pair of probabilistic machines <span class="math inline">\((A, B)\)</span> that take turns in sending messages to each other. At the end of the protocol, when both machines terminate, they both obtain the same value <span class="math inline">\(k\)</span>. A protocol transcript <span class="math inline">\(T_P\)</span> is the sequence of messages exchanged between the parties in one exe- cution of the protocol.</p>
</blockquote>
</section>
<section id="reads-cryptobook-1" class="level2">
<h2 class="anchored" data-anchor-id="reads-cryptobook-1">Reads <a href="https://toc.cryptobook.us/book.pdf">Cryptobook</a></h2>
<blockquote class="blockquote">
<p>Since <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are probabilistic machines, we obtain a different transcript every time we run the protocol. Formally, the transcript <span class="math inline">\(T_P\)</span> of protocol <span class="math inline">\(P\)</span> is a random variable, which is a function of the random bits generated by <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. The eavesdropping adversary <span class="math inline">\(E\)</span> sees the entire transcript <span class="math inline">\(T_P\)</span> and its goal is to figure out the secret <span class="math inline">\(k\)</span>.</p>
</blockquote>
</section>
<section id="set-the-stage" class="level2">
<h2 class="anchored" data-anchor-id="set-the-stage">Set the Stage</h2>
<ul>
<li>Snowden has e.g.&nbsp;files on a harddrive
<ul>
<li>The files contain keywords that cannot be safely transmitted over US-based internet connections.</li>
<li>Snowden is based in Hawai’i with no access to non-US-based connections.</li>
<li>Snowden needs to encrypt the files in such as a way that <em>only</em> a trusted destination may read them.</li>
</ul></li>
</ul>
</section>
<section id="first-contact" class="level2">
<h2 class="anchored" data-anchor-id="first-contact">First Contact</h2>
<ul>
<li>Snowden contacts Greenwald to agree to use a secure messaging protocol
<ul>
<li>Use of such protocols is relatively non-suspicious, used for banking etc.</li>
<li>It was enough to raise alarms for Snowden, but not quickly enough to stop him.</li>
</ul></li>
<li>Greenwald agrees to a recommended protocol</li>
</ul>
</section>
<section id="initialization" class="level2">
<h2 class="anchored" data-anchor-id="initialization">Initialization</h2>
<ul>
<li>Greenwald generates a combination of numerical values on a local computing device.
<ul>
<li>One of these is the public-key, which Greenwalk may circulate broadly.</li>
</ul></li>
<li>We see an example of such a technology on the next slide.</li>
</ul>
</section>
<section id="securedrop" class="level2">
<h2 class="anchored" data-anchor-id="securedrop">SecureDrop</h2>
<ul>
<li>Embed doesn’t work for what are likely obvious reasons:</li>
<li><a href="https://theintercept.com/source/">Link</a></li>
</ul>
<iframe id="source" title="source" width="70%" height="70%" src="https://theintercept.com/source/">
</iframe>
</section>
<section id="safety-note" class="level2">
<h2 class="anchored" data-anchor-id="safety-note">Safety Note</h2>
<ul>
<li>Probably dropping to <em>The Intercept</em> is not recommended.</li>
<li>Reality Winner is currently incarcerated due to a leak fumbled by <em>The Intercept</em></li>
<li><a href="https://www.google.com/search?client=firefox-b-1-d&amp;q=reality+winner">Read more</a></li>
</ul>
</section>
<section id="step-2" class="level2">
<h2 class="anchored" data-anchor-id="step-2">Step 2</h2>
<ul>
<li>Greenwald &amp; co. hold in reserve a <em>private-key</em></li>
<li>They defend it like lives depend on it, as they did for Winner and Snowden.</li>
<li>So: not stored in plaintext on a hard-drive</li>
<li>So: if on a hard-drive, hard-drive is in a secure site from e.g.&nbsp;federal law enforcement.</li>
</ul>
</section>
<section id="step-3" class="level2">
<h2 class="anchored" data-anchor-id="step-3">Step 3</h2>
<ul>
<li>Snowden, and hopefully enough others to avoid suspicion, use the public key to encrypt their payload.</li>
<li>In addition to e.g.&nbsp;top secret documents, concerned community members could send in less-secret materials such as analysis of policing data with which they would rather not be affiliated.</li>
<li>Journalists sift through the inputs.</li>
</ul>
</section>
<section id="its-that-simple" class="level2">
<h2 class="anchored" data-anchor-id="its-that-simple">It’s that simple</h2>
<ul>
<li>Okay but like how do we do that:
<ul>
<li>Any eaves-dropping adversary can see the public key.</li>
<li>One-to-one communication of a key is already dangerous</li>
<li>All this encryption/decryption needs to be managable by e.g.&nbsp;non-computing specialized journalists.</li>
</ul></li>
</ul>
</section>
</section>
<section id="digital-signatures" class="level1">
<h1>Digital Signatures</h1>
<section id="motivating-example-1" class="level2">
<h2 class="anchored" data-anchor-id="motivating-example-1">Motivating Example</h2>
<ul>
<li>I have a Bitcoin.</li>
<li>I can only spend it if other people can:
<ul>
<li>See it, to tell I have it</li>
<li>Not spend it, because it’s mine</li>
</ul></li>
<li>I use a digital signature.</li>
</ul>
</section>
<section id="a-transaction" class="level2">
<h2 class="anchored" data-anchor-id="a-transaction">A transaction</h2>
<blockquote class="blockquote">
<p>Each owner transfers the coin to the next by digitally signing a hash of the previous transaction and the public key of the next owner and adding these to the end of the coin</p>
</blockquote>
<ul>
<li>I own a coin.</li>
<li>I have a public keys.</li>
<li>I transfer that a coin to new owner to buy the <em>Grundrisse</em> translated to Quenya</li>
<li>This happens over the open internet.</li>
</ul>
</section>
<section id="signage" class="level2">
<h2 class="anchored" data-anchor-id="signage">Signage</h2>
<ul>
<li>To verify it is (1) my coin and (2) me transferring it, I:
<ul>
<li>Write down the transactions details.</li>
<li>SHA256 hash the message</li>
<li>Encrypt with my <strong>private key</strong></li>
<li>Release the hash and cipher (encrypted) text</li>
</ul></li>
</ul>
</section>
<section id="verify" class="level2">
<h2 class="anchored" data-anchor-id="verify">Verify</h2>
<ul>
<li>The general public:
<ul>
<li>Decrypts the ciphertext with my <strong>public key</strong></li>
<li>SHA256 hashes the decrypted text</li>
<li>If the hash matches our released hash, then it had to be us and the transaction is valid.</li>
</ul></li>
</ul>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div class="cell" data-fig-width="800px" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="800" height="480" viewbox="0.00 0.00 402.91 485.60" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 481.6)">
<title>RSA_Encryption</title>
<polygon fill="#191919" stroke="transparent" points="-4,4 -4,-481.6 398.91,-481.6 398.91,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_encryption</title>
<polygon fill="#191919" stroke="#ffffff" points="78,-284.8 78,-433.6 356,-433.6 356,-284.8 78,-284.8"></polygon>
<text text-anchor="middle" x="217" y="-417" font-family="Times,serif" font-size="14.00" fill="#ffffff">Encryption</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_decryption</title>
<polygon fill="#191919" stroke="#ffffff" points="8,-64 8,-212.8 292,-212.8 292,-64 8,-64"></polygon>
<text text-anchor="middle" x="150" y="-196.2" font-family="Times,serif" font-size="14.00" fill="#ffffff">Decryption</text>
</g>
<!-- message -->
<g id="node1" class="node">
<title>message</title>
<ellipse fill="none" stroke="#ffffff" cx="286" cy="-382.8" rx="62.02" ry="18"></ellipse>
<text text-anchor="middle" x="286" y="-378.6" font-family="Times,serif" font-size="14.00" fill="#ffffff">Message (M)</text>
</g>
<!-- encrypt -->
<g id="node2" class="node">
<title>encrypt</title>
<ellipse fill="none" stroke="#ffffff" cx="217" cy="-310.8" rx="67.17" ry="18"></ellipse>
<text text-anchor="middle" x="217" y="-306.6" font-family="Times,serif" font-size="14.00" fill="#ffffff">Ciphertext (C)</text>
</g>
<!-- message&#45;&gt;encrypt -->
<g id="edge1" class="edge">
<title>message-&gt;encrypt</title>
<path fill="none" stroke="#ffffff" d="M269.65,-365.21C260.88,-356.32 249.93,-345.21 240.29,-335.43"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="242.75,-332.93 233.23,-328.27 237.76,-337.85 242.75,-332.93"></polygon>
</g>
<!-- inter -->
<g id="node8" class="node">
<title>inter</title>
<ellipse fill="none" stroke="#ffffff" cx="217" cy="-238.8" rx="98.94" ry="18"></ellipse>
<text text-anchor="middle" x="217" y="-234.6" font-family="Times,serif" font-size="14.00" fill="#ffffff">Encrypted Transaction</text>
</g>
<!-- encrypt&#45;&gt;inter -->
<g id="edge6" class="edge">
<title>encrypt-&gt;inter</title>
<path fill="none" stroke="#ffffff" d="M217,-292.5C217,-284.78 217,-275.51 217,-266.91"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="220.5,-266.9 217,-256.9 213.5,-266.9 220.5,-266.9"></polygon>
</g>
<!-- public_key_ref -->
<g id="node3" class="node">
<title>public_key_ref</title>
<polygon fill="none" stroke="#ffffff" points="200.19,-400.8 85.81,-400.8 85.81,-364.8 206.19,-364.8 206.19,-394.8 200.19,-400.8"></polygon>
<polyline fill="none" stroke="#ffffff" points="200.19,-400.8 200.19,-394.8 "></polyline>
<polyline fill="none" stroke="#ffffff" points="206.19,-394.8 200.19,-394.8 "></polyline>
<text text-anchor="middle" x="146" y="-378.6" font-family="Times,serif" font-size="14.00" fill="#ffffff">Private Key: (n, d)</text>
</g>
<!-- public_key_ref&#45;&gt;encrypt -->
<g id="edge2" class="edge">
<title>public_key_ref-&gt;encrypt</title>
<path fill="none" stroke="#ffffff" d="M163.55,-364.5C172.36,-355.81 183.18,-345.14 192.77,-335.69"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="195.48,-337.94 200.14,-328.42 190.56,-332.95 195.48,-337.94"></polygon>
</g>
<!-- ciphertext -->
<g id="node4" class="node">
<title>ciphertext</title>
<ellipse fill="none" stroke="#ffffff" cx="217" cy="-162" rx="67.17" ry="18"></ellipse>
<text text-anchor="middle" x="217" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#ffffff">Ciphertext (C)</text>
</g>
<!-- decrypt -->
<g id="node5" class="node">
<title>decrypt</title>
<ellipse fill="none" stroke="#ffffff" cx="147" cy="-90" rx="62.02" ry="18"></ellipse>
<text text-anchor="middle" x="147" y="-85.8" font-family="Times,serif" font-size="14.00" fill="#ffffff">Message (M)</text>
</g>
<!-- ciphertext&#45;&gt;decrypt -->
<g id="edge3" class="edge">
<title>ciphertext-&gt;decrypt</title>
<path fill="none" stroke="#ffffff" d="M200.41,-144.41C191.52,-135.52 180.41,-124.41 170.63,-114.63"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="173.02,-112.07 163.47,-107.47 168.07,-117.02 173.02,-112.07"></polygon>
</g>
<!-- output -->
<g id="node9" class="node">
<title>output</title>
<ellipse fill="none" stroke="#ffffff" cx="147" cy="-18" rx="99" ry="18"></ellipse>
<text text-anchor="middle" x="147" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#ffffff">Decrypted Transaction</text>
</g>
<!-- decrypt&#45;&gt;output -->
<g id="edge8" class="edge">
<title>decrypt-&gt;output</title>
<path fill="none" stroke="#ffffff" d="M147,-71.7C147,-63.98 147,-54.71 147,-46.11"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="150.5,-46.1 147,-36.1 143.5,-46.1 150.5,-46.1"></polygon>
</g>
<!-- private_key_ref -->
<g id="node6" class="node">
<title>private_key_ref</title>
<polygon fill="none" stroke="#ffffff" points="125.53,-180 16.47,-180 16.47,-144 131.53,-144 131.53,-174 125.53,-180"></polygon>
<polyline fill="none" stroke="#ffffff" points="125.53,-180 125.53,-174 "></polyline>
<polyline fill="none" stroke="#ffffff" points="131.53,-174 125.53,-174 "></polyline>
<text text-anchor="middle" x="74" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#ffffff">Public Key: (n, e)</text>
</g>
<!-- private_key_ref&#45;&gt;decrypt -->
<g id="edge4" class="edge">
<title>private_key_ref-&gt;decrypt</title>
<path fill="none" stroke="#ffffff" d="M92.04,-143.7C101.2,-134.92 112.45,-124.13 122.38,-114.61"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="124.87,-117.07 129.67,-107.62 120.03,-112.02 124.87,-117.07"></polygon>
</g>
<!-- input -->
<g id="node7" class="node">
<title>input</title>
<ellipse fill="none" stroke="#ffffff" cx="286" cy="-459.6" rx="108.81" ry="18"></ellipse>
<text text-anchor="middle" x="286" y="-455.4" font-family="Times,serif" font-size="14.00" fill="#ffffff">Unencrypted Transaction</text>
</g>
<!-- input&#45;&gt;message -->
<g id="edge5" class="edge">
<title>input-&gt;message</title>
<path fill="none" stroke="#ffffff" d="M286,-441.25C286,-432.38 286,-421.36 286,-411.36"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="289.5,-411.05 286,-401.05 282.5,-411.05 289.5,-411.05"></polygon>
</g>
<!-- inter&#45;&gt;ciphertext -->
<g id="edge7" class="edge">
<title>inter-&gt;ciphertext</title>
<path fill="none" stroke="#ffffff" d="M217,-220.45C217,-211.58 217,-200.56 217,-190.56"></path>
<polygon fill="#ffffff" stroke="#ffffff" points="220.5,-190.25 217,-180.25 213.5,-190.25 220.5,-190.25"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
<section id="eddsa-algorithm" class="level1">
<h1>EdDSA, algorithm</h1>
<section id="eddsa" class="level2">
<h2 class="anchored" data-anchor-id="eddsa">EdDSA</h2>
<blockquote class="blockquote">
<p>In public-key cryptography, Edwards-curve Digital Signature Algorithm (EdDSA) is a digital signature scheme using a variant of Schnorr signature based on twisted Edwards curves.</p>
</blockquote>
<ul>
<li>Ah, that really clarifies things.</li>
</ul>
</section>
<section id="iterative-definition" class="level2">
<h2 class="anchored" data-anchor-id="iterative-definition">Iterative Definition</h2>
<p>An EdDSA signature scheme is a choice.</p>
</section>
<section id="iterative-definition-1" class="level2">
<h2 class="anchored" data-anchor-id="iterative-definition-1">Iterative Definition</h2>
<p>An EdDSA signature scheme is a choice over:</p>
<ul>
<li>A finite field <span class="math inline">\(\mathbb{F}_p\)</span> where we take <span class="math inline">\(p\)</span> to be an odd prime.</li>
</ul>
</section>
<section id="galois-field" class="level2">
<h2 class="anchored" data-anchor-id="galois-field">Galois field</h2>
<blockquote class="blockquote">
<p><a href="https://en.wikipedia.org/wiki/Finite_field">In mathematics, a finite field or Galois field (so-named in honor of Évariste Galois) is a field that has a finite number of elements. As with any field, a finite field is a set on which the operations of multiplication, addition, subtraction and division are defined and satisfy certain basic rules. The most common examples of finite fields are the integers mod p <span class="math inline">\(p\)</span> when <span class="math inline">\(p\)</span> is a prime number.</a></p>
</blockquote>
</section>
<section id="recall" class="level2">
<h2 class="anchored" data-anchor-id="recall">Recall</h2>
<ul>
<li>The<code>u</code><span class="math inline">\(n\)</span>s and <code>i</code><span class="math inline">\(n\)</span>’s in Rust are <em>rings</em>
<ul>
<li>They have addition and multiplication</li>
</ul></li>
<li>They aren’t fields - zero is divisible
<ul>
<li>Spoiler alert, but <span class="math inline">\(2^{\frac{n}{2}} \times 2^{\frac{n}{2}} \equiv 0 \pmod{2^n}\)</span></li>
</ul></li>
<li>So: not <span class="math inline">\(\mathbb{Z}/2^8\mathbb{Z}\)</span>
<ul>
<li>What about <span class="math inline">\(\mathbb{Z}/(2^8+1)\mathbb{Z}\)</span>?
<ul>
<li>That’s <span class="math inline">\(\mathbb{F}_p\)</span> where <span class="math inline">\(p = 2^8+1\)</span></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="iterative-definition-2" class="level2">
<h2 class="anchored" data-anchor-id="iterative-definition-2">Iterative Definition</h2>
<p>An EdDSA signature scheme is a choice over:</p>
<ul>
<li>A finite field <span class="math inline">\(\mathbb{F}_p\)</span>.</li>
<li>An elliptic curve <span class="math inline">\(E\)</span> over <span class="math inline">\(\mathbb{F}_p\)</span>
<ul>
<li>We simply as:
<ul>
<li>A plane curve over</li>
<li>A finite field</li>
<li>of form <span class="math inline">\(a x^2+y^2= 1+dx^2y^2\)</span></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="plane-curve" class="level2">
<h2 class="anchored" data-anchor-id="plane-curve">Plane Curve</h2>
<blockquote class="blockquote">
<p><a href="https://en.wikipedia.org/wiki/Plane_curve">In mathematics, a plane curve is a curve in a plane that may be a Euclidean plane, an affine plane or a projective plane. The most frequently studied cases are smooth plane curves (including piecewise smooth plane curves), and algebraic plane curves. Plane curves also include the Jordan curves (curves that enclose a region of the plane but need not be smooth) and the graphs of continuous functions.</a></p>
</blockquote>
</section>
<section id="graphs-of-continous-functions" class="level2">
<h2 class="anchored" data-anchor-id="graphs-of-continous-functions">Graphs of Continous Functions</h2>
<ul>
<li>Often express as <span class="math inline">\(f(x,y) = 0\)</span></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> sympy</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>curve <span class="op">=</span> sympy.Eq(<span class="dv">0</span>,x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> r)</span>
<span id="cb1-9"><a href="#cb1-9"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb1-10"><a href="#cb1-10"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span>r, r, <span class="dv">1000</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<div id="9d5cecfb" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="80_eddsa_files/figure-html/cell-2-output-1.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="iterative-definition-3" class="level2">
<h2 class="anchored" data-anchor-id="iterative-definition-3">Iterative Definition</h2>
<p>An EdDSA signature scheme is a choice over:</p>
<ul>
<li>A finite field <span class="math inline">\(\mathbb{F}_p\)</span>.</li>
<li>An elliptic curve <span class="math inline">\(E\)</span> over <span class="math inline">\(\mathbb{F}_p\)</span>
<ul>
<li>Whose group <span class="math inline">\(E(\mathbb{F}_p)\)</span> of <span class="math inline">\(\mathbb{F}_p\)</span>-rational points has order <span class="math inline">\(|E(\mathbb{F}_p)| = 2^C \ell\)</span> where <span class="math inline">\(\ell\)</span> is a large primce and <span class="math inline">\(2^c\)</span> is the cofactor
<ul>
<li>Take a 400-level math class</li>
<li>Basically this is a measure of the area within the ellipse.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="iterative-definition-4" class="level2">
<h2 class="anchored" data-anchor-id="iterative-definition-4">Iterative Definition</h2>
<p>An EdDSA signature scheme is a choice over:</p>
<ul>
<li>A finite field <span class="math inline">\(\mathbb{F}_p\)</span>.</li>
<li>An elliptic curve <span class="math inline">\(E\)</span> over <span class="math inline">\(\mathbb{F}_p\)</span></li>
<li>A base point <span class="math inline">\(B \in E(\mathbb{F}_p)\)</span>
<ul>
<li>This is the only parameter set when generating your own keys.</li>
<li>Everything else is pre-computed.</li>
<li>Basically a point on the curve.</li>
</ul></li>
</ul>
</section>
<section id="iterative-definition-5" class="level2">
<h2 class="anchored" data-anchor-id="iterative-definition-5">Iterative Definition</h2>
<p>An EdDSA signature scheme is a choice over:</p>
<ul>
<li>A finite field <span class="math inline">\(\mathbb{F}_p\)</span>.</li>
<li>An elliptic curve <span class="math inline">\(E\)</span> over <span class="math inline">\(\mathbb{F}_p\)</span></li>
<li>A base point <span class="math inline">\(B \in E(\mathbb{F}_p)\)</span></li>
<li>A hash function <span class="math inline">\(H\)</span> with <span class="math inline">\(2b\)</span>-bit outputs, where <span class="math inline">\(2^{b-1} &gt; q\)</span>
<ul>
<li>This just allows machine representation.</li>
</ul></li>
</ul>
</section>
</section>
<section id="eddsa-terms" class="level1">
<h1>EdDSA, terms</h1>
<section id="public-key" class="level2">
<h2 class="anchored" data-anchor-id="public-key">Public key</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Public key
</div>
</div>
<div class="callout-body-container callout-body">
<p>An EdDSA <em>public key</em> is a curve point <span class="math inline">\(A \in E(\mathbb{F}_p)\)</span> encoded in <span class="math inline">\(b\)</span> bits</p>
</div>
</div>
</section>
<section id="signature-verification" class="level2">
<h2 class="anchored" data-anchor-id="signature-verification">Signature verification</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Signature verification
</div>
</div>
<div class="callout-body-container callout-body">
<p>An EdDSA <em>signature</em> on a message <span class="math inline">\(M\)</span> by public <span class="math inline">\(A\)</span> is the (ordered) pair <span class="math inline">\((R,S)\)</span> encoded in <span class="math inline">\(2b\)</span> bits, where <span class="math inline">\(R\)</span> is a curve point <span class="math inline">\(R \in E(\mathbb{F}_p)\)</span> and <span class="math inline">\(S\)</span> is non-negative integer less than the size of the large prime <span class="math inline">\(\ell\)</span>. <span class="math inline">\((R,S)\)</span> must satisfy the following equation (where <span class="math inline">\(\parallel\)</span> is string concatenation).</p>
<p><span class="math display">\[
2^c S B = 2^c R + 2^c H(R \parallel A \parallel M) A
\]</span></p>
</div>
</div>
</section>
<section id="private-key" class="level2">
<h2 class="anchored" data-anchor-id="private-key">Private key</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Private key
</div>
</div>
<div class="callout-body-container callout-body">
<p>An EdDSA private key is a <span class="math inline">\(b\)</span>-bit string <span class="math inline">\(k\)</span> which should be chosen uniformly at random. The corresponding public key is <span class="math inline">\(A = s B\)</span>, where <span class="math inline">\(s = H_{0,\dots,b - 1}(k)\)</span> is the least significant <span class="math inline">\(b\)</span> bits of <span class="math inline">\(H(k)\)</span> interpreted as an integer.</p>
</div>
</div>
</section>
<section id="signing" class="level2">
<h2 class="anchored" data-anchor-id="signing">Signing</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Signing
</div>
</div>
<div class="callout-body-container callout-body">
<p>The signature on a message <span class="math inline">\(M\)</span> is deterministically computed as <span class="math inline">\((R, S)\)</span> where <span class="math inline">\(R = r B\)</span> for <span class="math inline">\(r = H(H_{b,\dots,2b - 1}(k) \parallel M)\)</span>, and <span class="math display">\[
S \equiv r + H(R \parallel A \parallel M) s \pmod \ell
\]</span> This satisfies the verification equation <span class="math display">\[
\begin{align}
2^c S B &amp;= 2^c (r + H(R \parallel A \parallel M) s) B \\
        &amp;= 2^c r B + 2^c H(R \parallel A \parallel M) s B \\
        &amp;= 2^c R + 2^c H(R \parallel A \parallel M) A.
\end{align}
\]</span></p>
</div>
</div>
</section>
</section>
<section id="eddsa-ed25519" class="level1">
<h1>EdDSA, Ed25519</h1>
<section id="ed25519" class="level2">
<h2 class="anchored" data-anchor-id="ed25519">Ed25519</h2>
<ul>
<li>EdDSA with:
<ul>
<li>SHA-512</li>
<li>Curve25519</li>
</ul></li>
</ul>
</section>
<section id="curve25519" class="level2">
<h2 class="anchored" data-anchor-id="curve25519">Curve25519</h2>
<ul>
<li>An unusually fast curve to calculate on modern CPUs</li>
<li><em>Not</em> made me the NSA, and released after an NSA released curve was discovered to have a backdoor.</li>
<li>Named for being over the prime field <span class="math inline">\(2^{255}-19\)</span> - hence 25519</li>
</ul>
</section>
<section id="visualize" class="level2">
<h2 class="anchored" data-anchor-id="visualize">Visualize</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">import</span> sympy</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>curve <span class="op">=</span> sympy.Eq(y<span class="op">*</span>y, x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">486662</span><span class="op">*</span>x<span class="op">*</span>x <span class="op">+</span> x)</span>
<span id="cb2-7"><a href="#cb2-7"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb2-8"><a href="#cb2-8"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">.00001</span>, <span class="fl">.00001</span>, <span class="dv">1000</span>)</span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<div id="78d1f1dc" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stderr">
<pre><code>&lt;lambdifygenerated-2&gt;:2: RuntimeWarning:

invalid value encountered in sqrt
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="80_eddsa_files/figure-html/cell-3-output-2.png" width="599" height="428" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="bernstein" class="level2">
<h2 class="anchored" data-anchor-id="bernstein">Bernstein</h2>
<ul>
<li>Discovered by a team including Daniel J. Bernstein.</li>
</ul>
<blockquote class="blockquote">
<p>The export of cryptography from the United States was controlled as a munition starting from the Cold War until recategorization in 1996, with further relaxation in the late 1990s. In 1995, Bernstein brought the court case Bernstein v. United States. The ruling in the case declared that software was protected speech under the First Amendment, which contributed to regulatory changes reducing controls on encryption.</p>
</blockquote>
</section>
<section id="lange" class="level2">
<h2 class="anchored" data-anchor-id="lange">Lange</h2>
<ul>
<li>Discovered by a team including Tanja Lange.
<ul>
<li>Academic and anti-surveillance activist</li>
<li>Easy to find website with public keys:</li>
</ul></li>
<li><a href="https://hyperelliptic.org/tanja/">Peep these keys!</a></li>
</ul>
</section>
<section id="p" class="level2">
<h2 class="anchored" data-anchor-id="p"><span class="math inline">\(p\)</span></h2>
<ul>
<li><span class="math inline">\(p = 2^255-19\)</span> so</li>
<li><span class="math inline">\(F_p = \mathbb{F}_{2^{255}-19}\)</span></li>
</ul>
</section>
<section id="emathbbf_2255-19" class="level2">
<h2 class="anchored" data-anchor-id="emathbbf_2255-19"><span class="math inline">\(E/\mathbb{F}_{2^{255}-19}\)</span></h2>
<ul>
<li>Take the “twisted Edwards curve”</li>
</ul>
<p><span class="math display">\[
-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2
\]</span></p>
</section>
<section id="visualize-1" class="level2">
<h2 class="anchored" data-anchor-id="visualize-1">Visualize</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource py number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="im">import</span> sympy</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>curve <span class="op">=</span> sympy.Eq(<span class="op">-</span>x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y, <span class="dv">1</span> <span class="op">-</span> (<span class="dv">121665</span><span class="op">/</span><span class="dv">121666</span>)<span class="op">*</span>x<span class="op">*</span>x<span class="op">*</span>y<span class="op">*</span>y)</span>
<span id="cb4-7"><a href="#cb4-7"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb4-8"><a href="#cb4-8"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<div id="68c059d2" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="80_eddsa_files/figure-html/cell-4-output-1.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ed25519-1" class="level2">
<h2 class="anchored" data-anchor-id="ed25519-1">Ed25519</h2>
<ul>
<li><span class="math inline">\(p = 2^{255}-19\)</span> so</li>
<li><span class="math inline">\(F_p = \mathbb{F}_{2^{255}-19}\)</span></li>
<li><span class="math inline">\(E/\mathbb{F}_{2^{255}-19}\)</span> is <span class="math inline">\(-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2\)</span></li>
</ul>
</section>
<section id="ed25519-2" class="level2">
<h2 class="anchored" data-anchor-id="ed25519-2">Ed25519</h2>
<ul>
<li><span class="math inline">\(p = 2^{255}-19\)</span> so</li>
<li><span class="math inline">\(F_p = \mathbb{F}_{2^{255}-19}\)</span></li>
<li><span class="math inline">\(E/\mathbb{F}_{2^{255}-19}\)</span> is <span class="math inline">\(-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2\)</span></li>
<li><span class="math inline">\(\ell = 2^{252} + 27742317777372353535851937790883648493\)</span></li>
</ul>
</section>
<section id="ed25519-3" class="level2">
<h2 class="anchored" data-anchor-id="ed25519-3">Ed25519</h2>
<ul>
<li><span class="math inline">\(p = 2^{255}-19\)</span> so</li>
<li><span class="math inline">\(F_p = \mathbb{F}_{2^{255}-19}\)</span></li>
<li><span class="math inline">\(E/\mathbb{F}_{2^{255}-19}\)</span> is <span class="math inline">\(-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2\)</span></li>
<li><span class="math inline">\(\ell = 2^{252} + 27742317777372353535851937790883648493\)</span></li>
<li><span class="math inline">\(c = 3\)</span></li>
</ul>
</section>
<section id="ed25519-4" class="level2">
<h2 class="anchored" data-anchor-id="ed25519-4">Ed25519</h2>
<ul>
<li><span class="math inline">\(p = 2^{255}-19\)</span> so</li>
<li><span class="math inline">\(F_p = \mathbb{F}_{2^{255}-19}\)</span></li>
<li><span class="math inline">\(E/\mathbb{F}_{2^{255}-19}\)</span> is <span class="math inline">\(-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2\)</span></li>
<li><span class="math inline">\(\ell = 2^{252} + 27742317777372353535851937790883648493\)</span></li>
<li><span class="math inline">\(c = 3\)</span></li>
</ul>
</section>
<section id="ed25519-definitions" class="level2">
<h2 class="anchored" data-anchor-id="ed25519-definitions">Ed25519, definitions</h2>
<ul>
<li>Take the “base point” <span class="math inline">\(B\)</span> to be the unique point with <span class="math inline">\(y = \frac{4}{5}\)</span> and “positive” <span class="math inline">\(x\)</span>
<ul>
<li><span class="math inline">\(x\)</span> to be positive via its <em>bit-encoding</em>
<ul>
<li>“positive” coordinates are even coordinates (least significant bit is cleared)</li>
<li>“negative” coordinates are odd coordinates (least significant bit is set)</li>
</ul></li>
</ul></li>
<li>Then let <span class="math inline">\(H\)</span> be SHA-512, given a <span class="math inline">\(b\)</span> (bit size) of 256.
<ul>
<li>Hashes are of size <span class="math inline">\(2b\)</span></li>
</ul></li>
</ul>
</section>
</section>
<section id="ed25519-takeaways" class="level1">
<h1>Ed25519, Takeaways</h1>
<ul>
<li>EdDSA a combination of equations that require a choice of constants.</li>
<li>Ed25519 is a uniquely good set of constants.</li>
<li>Together, they are basically a function that makes public and private keys.
<ul>
<li>A public key tells someone how to encrypt something so that only someone with…</li>
<li>The corresponding private key can decrypt it</li>
</ul></li>
<li>Used to sign bitcoin, git commits, e-commerce…</li>
</ul>
<section id="learn-more" class="level2">
<h2 class="anchored" data-anchor-id="learn-more">Learn More</h2>
<ul>
<li>The best way to understand Ed25519 is to implement it.
<ul>
<li>It was released as software in Python, though Python 2.</li>
<li>You will implement in Rust.</li>
</ul></li>
</ul>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./72_ix.html" class="pagination-link" aria-label="ix">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">ix</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./81_python.html" class="pagination-link" aria-label="Python">
        <span class="nav-page-text">Python</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb5" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">---</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="an">title:</span><span class="co"> "EdDSA"</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">---</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu"># Announcements</span></span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="ss">- </span>**Welcome** to Systems in Rust</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="ss">- </span>**Action Items**:</span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="ss">  - </span>Midterms verbal update.</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="ss">  - </span>Keep at <span class="in">`ix`</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="ss">  - </span>This unlocks the last and greatest of the cryptographic homeworks so we can get to graph theory.</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="fu">## Today</span></span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="ss">- </span>Private Key Cryptography</span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="ss">- </span>Digital Signatures</span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="ss">- </span>Edwards-curve Digital Signature Algorithm (EdDSA) </span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="ss">    - </span>Some math where we need it</span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="ss">    - </span>An aside on side channels if we get bored</span>
<span id="cb5-21"><a href="#cb5-21"></a>  </span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="fu"># Public Key Cryptography</span></span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="fu">## Motivating Example</span></span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="ss">- </span>Canonical Example is Snowden x Greenwald 2013</span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="ss">  - </span>Snowden wished to communicate a secret to Greenwald</span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="ss">  - </span>Snowden and Greenwald had never met</span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="ss">  - </span>Snowden could not transmit the secret in plain text</span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="ss">- </span>Vs enigma, no prior agreement on how to encrypt/decrypt</span>
<span id="cb5-32"><a href="#cb5-32"></a></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="fu">## Reads [Cryptobook](https://toc.cryptobook.us/book.pdf)</span></span>
<span id="cb5-34"><a href="#cb5-34"></a></span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="at">&gt; A key exchange protocol $P$ is a pair of probabilistic machines $(A, B)$ that take turns in sending messages to each other.</span></span>
<span id="cb5-36"><a href="#cb5-36"></a><span class="at">At the end of the protocol, when both machines terminate, they both obtain the same value $k$. A</span></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="at">protocol transcript $T_P$ is the sequence of messages exchanged between the parties in one exe-</span></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="at">cution of the protocol. </span></span>
<span id="cb5-39"><a href="#cb5-39"></a></span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="fu">## Reads [Cryptobook](https://toc.cryptobook.us/book.pdf)</span></span>
<span id="cb5-41"><a href="#cb5-41"></a></span>
<span id="cb5-42"><a href="#cb5-42"></a><span class="at">&gt; Since $A$ and $B$ are probabilistic machines, we obtain a different transcript</span></span>
<span id="cb5-43"><a href="#cb5-43"></a><span class="at">every time we run the protocol. Formally, the transcript $T_P$ of protocol $P$ is a random variable, which is a function of the random bits generated by $A$ and $B$. The eavesdropping adversary $E$ sees the entire transcript $T_P$ and its goal is to figure out the secret $k$.</span></span>
<span id="cb5-44"><a href="#cb5-44"></a></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="fu">## Set the Stage</span></span>
<span id="cb5-46"><a href="#cb5-46"></a></span>
<span id="cb5-47"><a href="#cb5-47"></a><span class="ss">- </span>Snowden has e.g. files on a harddrive</span>
<span id="cb5-48"><a href="#cb5-48"></a><span class="ss">  - </span>The files contain keywords that cannot be safely transmitted over US-based internet connections.</span>
<span id="cb5-49"><a href="#cb5-49"></a><span class="ss">  - </span>Snowden is based in Hawai'i with no access to non-US-based connections.</span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="ss">  - </span>Snowden needs to encrypt the files in such as a way that *only* a trusted destination may read them.</span>
<span id="cb5-51"><a href="#cb5-51"></a></span>
<span id="cb5-52"><a href="#cb5-52"></a><span class="fu">## First Contact</span></span>
<span id="cb5-53"><a href="#cb5-53"></a></span>
<span id="cb5-54"><a href="#cb5-54"></a><span class="ss">- </span>Snowden contacts Greenwald to agree to use a secure messaging protocol</span>
<span id="cb5-55"><a href="#cb5-55"></a><span class="ss">  - </span>Use of such protocols is relatively non-suspicious, used for banking etc.</span>
<span id="cb5-56"><a href="#cb5-56"></a><span class="ss">  - </span>It was enough to raise alarms for Snowden, but not quickly enough to stop him.</span>
<span id="cb5-57"><a href="#cb5-57"></a><span class="ss">- </span>Greenwald agrees to a recommended protocol</span>
<span id="cb5-58"><a href="#cb5-58"></a></span>
<span id="cb5-59"><a href="#cb5-59"></a><span class="fu">## Initialization</span></span>
<span id="cb5-60"><a href="#cb5-60"></a></span>
<span id="cb5-61"><a href="#cb5-61"></a><span class="ss">- </span>Greenwald generates a combination of numerical values on a local computing device.</span>
<span id="cb5-62"><a href="#cb5-62"></a><span class="ss">  - </span>One of these is the public-key, which Greenwalk may circulate broadly.</span>
<span id="cb5-63"><a href="#cb5-63"></a><span class="ss">- </span>We see an example of such a technology on the next slide.</span>
<span id="cb5-64"><a href="#cb5-64"></a></span>
<span id="cb5-65"><a href="#cb5-65"></a><span class="fu">## SecureDrop</span></span>
<span id="cb5-66"><a href="#cb5-66"></a></span>
<span id="cb5-67"><a href="#cb5-67"></a><span class="ss">- </span>Embed doesn't work for what are likely obvious reasons:</span>
<span id="cb5-68"><a href="#cb5-68"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Link</span><span class="co">](https://theintercept.com/source/)</span></span>
<span id="cb5-69"><a href="#cb5-69"></a></span>
<span id="cb5-70"><a href="#cb5-70"></a>&lt;iframe </span>
<span id="cb5-71"><a href="#cb5-71"></a>  id="source"</span>
<span id="cb5-72"><a href="#cb5-72"></a>  title="source"</span>
<span id="cb5-73"><a href="#cb5-73"></a>  width="70%"</span>
<span id="cb5-74"><a href="#cb5-74"></a>  height="70%"</span>
<span id="cb5-75"><a href="#cb5-75"></a>  src="https://theintercept.com/source/"&gt;&lt;/iframe&gt;</span>
<span id="cb5-76"><a href="#cb5-76"></a></span>
<span id="cb5-77"><a href="#cb5-77"></a><span class="fu">## Safety Note</span></span>
<span id="cb5-78"><a href="#cb5-78"></a></span>
<span id="cb5-79"><a href="#cb5-79"></a><span class="ss">- </span>Probably dropping to *The Intercept* is not recommended.</span>
<span id="cb5-80"><a href="#cb5-80"></a><span class="ss">- </span>Reality Winner is currently incarcerated due to a leak fumbled by *The Intercept*</span>
<span id="cb5-81"><a href="#cb5-81"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Read more</span><span class="co">](https://www.google.com/search?client=firefox-b-1-d&amp;q=reality+winner)</span></span>
<span id="cb5-82"><a href="#cb5-82"></a></span>
<span id="cb5-83"><a href="#cb5-83"></a><span class="fu">## Step 2</span></span>
<span id="cb5-84"><a href="#cb5-84"></a></span>
<span id="cb5-85"><a href="#cb5-85"></a><span class="ss">- </span>Greenwald &amp; co. hold in reserve a *private-key*</span>
<span id="cb5-86"><a href="#cb5-86"></a><span class="ss">- </span>They defend it like lives depend on it, as they did for Winner and Snowden.</span>
<span id="cb5-87"><a href="#cb5-87"></a><span class="ss">- </span>So: not stored in plaintext on a hard-drive</span>
<span id="cb5-88"><a href="#cb5-88"></a><span class="ss">- </span>So: if on a hard-drive, hard-drive is in a secure site from e.g. federal law enforcement.</span>
<span id="cb5-89"><a href="#cb5-89"></a></span>
<span id="cb5-90"><a href="#cb5-90"></a><span class="fu">## Step 3</span></span>
<span id="cb5-91"><a href="#cb5-91"></a></span>
<span id="cb5-92"><a href="#cb5-92"></a><span class="ss">- </span>Snowden, and hopefully enough others to avoid suspicion, use the public key to encrypt their payload.</span>
<span id="cb5-93"><a href="#cb5-93"></a><span class="ss">- </span>In addition to e.g. top secret documents, concerned community members could send in less-secret materials such as analysis of policing data with which they would rather not be affiliated.</span>
<span id="cb5-94"><a href="#cb5-94"></a><span class="ss">- </span>Journalists sift through the inputs.</span>
<span id="cb5-95"><a href="#cb5-95"></a></span>
<span id="cb5-96"><a href="#cb5-96"></a><span class="fu">## It's that simple</span></span>
<span id="cb5-97"><a href="#cb5-97"></a></span>
<span id="cb5-98"><a href="#cb5-98"></a><span class="ss">- </span>Okay but like how do we do that:</span>
<span id="cb5-99"><a href="#cb5-99"></a><span class="ss">  - </span>Any eaves-dropping adversary can see the public key.</span>
<span id="cb5-100"><a href="#cb5-100"></a><span class="ss">  - </span>One-to-one communication of a key is already dangerous</span>
<span id="cb5-101"><a href="#cb5-101"></a><span class="ss">  - </span>All this encryption/decryption needs to be managable by e.g. non-computing specialized journalists.</span>
<span id="cb5-102"><a href="#cb5-102"></a>  </span>
<span id="cb5-103"><a href="#cb5-103"></a><span class="fu"># Digital Signatures</span></span>
<span id="cb5-104"><a href="#cb5-104"></a></span>
<span id="cb5-105"><a href="#cb5-105"></a><span class="fu">## Motivating Example</span></span>
<span id="cb5-106"><a href="#cb5-106"></a></span>
<span id="cb5-107"><a href="#cb5-107"></a><span class="ss">- </span>I have a Bitcoin.</span>
<span id="cb5-108"><a href="#cb5-108"></a><span class="ss">- </span>I can only spend it if other people can:</span>
<span id="cb5-109"><a href="#cb5-109"></a><span class="ss">    - </span>See it, to tell I have it</span>
<span id="cb5-110"><a href="#cb5-110"></a><span class="ss">    - </span>Not spend it, because it's mine</span>
<span id="cb5-111"><a href="#cb5-111"></a><span class="ss">- </span>I use a digital signature.</span>
<span id="cb5-112"><a href="#cb5-112"></a></span>
<span id="cb5-113"><a href="#cb5-113"></a></span>
<span id="cb5-114"><a href="#cb5-114"></a><span class="fu">## A transaction</span></span>
<span id="cb5-115"><a href="#cb5-115"></a></span>
<span id="cb5-116"><a href="#cb5-116"></a><span class="at">&gt; Each owner transfers the coin to the next by digitally signing a hash of the previous transaction and the public key of the next owner and adding these to the end of the coin</span></span>
<span id="cb5-117"><a href="#cb5-117"></a></span>
<span id="cb5-118"><a href="#cb5-118"></a><span class="ss">- </span>I own a coin.</span>
<span id="cb5-119"><a href="#cb5-119"></a><span class="ss">- </span>I have a public keys.</span>
<span id="cb5-120"><a href="#cb5-120"></a><span class="ss">- </span>I transfer that a coin to new owner to buy the *Grundrisse* translated to Quenya</span>
<span id="cb5-121"><a href="#cb5-121"></a><span class="ss">- </span>This happens over the open internet.</span>
<span id="cb5-122"><a href="#cb5-122"></a></span>
<span id="cb5-123"><a href="#cb5-123"></a><span class="fu">## Signage</span></span>
<span id="cb5-124"><a href="#cb5-124"></a></span>
<span id="cb5-125"><a href="#cb5-125"></a><span class="ss">- </span>To verify it is (1) my coin and (2) me transferring it, I:</span>
<span id="cb5-126"><a href="#cb5-126"></a><span class="ss">    - </span>Write down the transactions details.</span>
<span id="cb5-127"><a href="#cb5-127"></a><span class="ss">    - </span>SHA256 hash the message</span>
<span id="cb5-128"><a href="#cb5-128"></a><span class="ss">    - </span>Encrypt with my **private key**</span>
<span id="cb5-129"><a href="#cb5-129"></a><span class="ss">    - </span>Release the hash and cipher (encrypted) text</span>
<span id="cb5-130"><a href="#cb5-130"></a></span>
<span id="cb5-131"><a href="#cb5-131"></a><span class="fu">## Verify</span></span>
<span id="cb5-132"><a href="#cb5-132"></a></span>
<span id="cb5-133"><a href="#cb5-133"></a><span class="ss">- </span>The general public:</span>
<span id="cb5-134"><a href="#cb5-134"></a><span class="ss">    - </span>Decrypts the ciphertext with my **public key**</span>
<span id="cb5-135"><a href="#cb5-135"></a><span class="ss">    - </span>SHA256 hashes the decrypted text</span>
<span id="cb5-136"><a href="#cb5-136"></a><span class="ss">    - </span>If the hash matches our released hash, then it had to be us and the transaction is valid.</span>
<span id="cb5-137"><a href="#cb5-137"></a></span>
<span id="cb5-138"><a href="#cb5-138"></a><span class="fu">## </span></span>
<span id="cb5-139"><a href="#cb5-139"></a></span>
<span id="cb5-142"><a href="#cb5-142"></a><span class="in">```{dot}</span></span>
<span id="cb5-143"><a href="#cb5-143"></a><span class="in">//| fig-width: 800px</span></span>
<span id="cb5-144"><a href="#cb5-144"></a><span class="in">//| echo: false</span></span>
<span id="cb5-145"><a href="#cb5-145"></a><span class="in">digraph RSA_Encryption {</span></span>
<span id="cb5-146"><a href="#cb5-146"></a><span class="in">  bgcolor="#191919";</span></span>
<span id="cb5-147"><a href="#cb5-147"></a><span class="in">  node [fontcolor = "#ffffff", color = "#ffffff"]</span></span>
<span id="cb5-148"><a href="#cb5-148"></a><span class="in">  edge [color = "#ffffff", fontcolor = "#ffffff"]</span></span>
<span id="cb5-149"><a href="#cb5-149"></a></span>
<span id="cb5-150"><a href="#cb5-150"></a><span class="in">  // Encryption</span></span>
<span id="cb5-151"><a href="#cb5-151"></a><span class="in">  subgraph cluster_encryption {</span></span>
<span id="cb5-152"><a href="#cb5-152"></a><span class="in">    fontcolor = "#ffffff";</span></span>
<span id="cb5-153"><a href="#cb5-153"></a><span class="in">    color = "#ffffff";</span></span>
<span id="cb5-154"><a href="#cb5-154"></a><span class="in">    label = "Encryption";</span></span>
<span id="cb5-155"><a href="#cb5-155"></a><span class="in">    message [label="Message (M)"];</span></span>
<span id="cb5-156"><a href="#cb5-156"></a><span class="in">    encrypt [label="Ciphertext (C)"];</span></span>
<span id="cb5-157"><a href="#cb5-157"></a><span class="in">    public_key_ref [label="Private Key: (n, d)", shape=note];</span></span>
<span id="cb5-158"><a href="#cb5-158"></a></span>
<span id="cb5-159"><a href="#cb5-159"></a><span class="in">    message -&gt; encrypt;</span></span>
<span id="cb5-160"><a href="#cb5-160"></a><span class="in">    public_key_ref -&gt; encrypt;</span></span>
<span id="cb5-161"><a href="#cb5-161"></a><span class="in">  }</span></span>
<span id="cb5-162"><a href="#cb5-162"></a></span>
<span id="cb5-163"><a href="#cb5-163"></a><span class="in">  // Decryption</span></span>
<span id="cb5-164"><a href="#cb5-164"></a><span class="in">  subgraph cluster_decryption {</span></span>
<span id="cb5-165"><a href="#cb5-165"></a><span class="in">    fontcolor = "#ffffff";</span></span>
<span id="cb5-166"><a href="#cb5-166"></a><span class="in">    color = "#ffffff";</span></span>
<span id="cb5-167"><a href="#cb5-167"></a><span class="in">    label = "Decryption";</span></span>
<span id="cb5-168"><a href="#cb5-168"></a><span class="in">    ciphertext [label="Ciphertext (C)"];</span></span>
<span id="cb5-169"><a href="#cb5-169"></a><span class="in">    decrypt [label="Message (M)"];</span></span>
<span id="cb5-170"><a href="#cb5-170"></a><span class="in">    private_key_ref [label="Public Key: (n, e)", shape=note];</span></span>
<span id="cb5-171"><a href="#cb5-171"></a></span>
<span id="cb5-172"><a href="#cb5-172"></a><span class="in">    ciphertext -&gt; decrypt;</span></span>
<span id="cb5-173"><a href="#cb5-173"></a><span class="in">    private_key_ref -&gt; decrypt;</span></span>
<span id="cb5-174"><a href="#cb5-174"></a><span class="in">  }</span></span>
<span id="cb5-175"><a href="#cb5-175"></a></span>
<span id="cb5-176"><a href="#cb5-176"></a><span class="in">  input [label="Unencrypted Transaction"]</span></span>
<span id="cb5-177"><a href="#cb5-177"></a><span class="in">  inter [label="Encrypted Transaction"]</span></span>
<span id="cb5-178"><a href="#cb5-178"></a><span class="in">  output [label="Decrypted Transaction"]</span></span>
<span id="cb5-179"><a href="#cb5-179"></a></span>
<span id="cb5-180"><a href="#cb5-180"></a><span class="in">  // Connections between steps</span></span>
<span id="cb5-181"><a href="#cb5-181"></a><span class="in">  input -&gt; message;</span></span>
<span id="cb5-182"><a href="#cb5-182"></a><span class="in">  encrypt -&gt; inter;</span></span>
<span id="cb5-183"><a href="#cb5-183"></a><span class="in">  inter -&gt; ciphertext;</span></span>
<span id="cb5-184"><a href="#cb5-184"></a><span class="in">  decrypt -&gt; output;</span></span>
<span id="cb5-185"><a href="#cb5-185"></a><span class="in">}</span></span>
<span id="cb5-186"><a href="#cb5-186"></a><span class="in">```</span></span>
<span id="cb5-187"><a href="#cb5-187"></a></span>
<span id="cb5-188"><a href="#cb5-188"></a>  </span>
<span id="cb5-189"><a href="#cb5-189"></a><span class="fu"># EdDSA, algorithm</span></span>
<span id="cb5-190"><a href="#cb5-190"></a> </span>
<span id="cb5-191"><a href="#cb5-191"></a><span class="fu">## EdDSA</span></span>
<span id="cb5-192"><a href="#cb5-192"></a></span>
<span id="cb5-193"><a href="#cb5-193"></a><span class="at">&gt; In public-key cryptography, Edwards-curve Digital Signature Algorithm (EdDSA) is a digital signature scheme using a variant of Schnorr signature based on twisted Edwards curves.</span></span>
<span id="cb5-194"><a href="#cb5-194"></a></span>
<span id="cb5-195"><a href="#cb5-195"></a><span class="ss">- </span>Ah, that really clarifies things.</span>
<span id="cb5-196"><a href="#cb5-196"></a></span>
<span id="cb5-197"><a href="#cb5-197"></a><span class="fu">## Iterative Definition</span></span>
<span id="cb5-198"><a href="#cb5-198"></a></span>
<span id="cb5-199"><a href="#cb5-199"></a>An EdDSA signature scheme is a choice.</span>
<span id="cb5-200"><a href="#cb5-200"></a></span>
<span id="cb5-201"><a href="#cb5-201"></a><span class="fu">## Iterative Definition</span></span>
<span id="cb5-202"><a href="#cb5-202"></a></span>
<span id="cb5-203"><a href="#cb5-203"></a>An EdDSA signature scheme is a choice over:</span>
<span id="cb5-204"><a href="#cb5-204"></a></span>
<span id="cb5-205"><a href="#cb5-205"></a><span class="ss">- </span>A finite field $\mathbb{F}_p$ where we take $p$ to be an odd prime.</span>
<span id="cb5-206"><a href="#cb5-206"></a></span>
<span id="cb5-207"><a href="#cb5-207"></a><span class="fu">## Galois field</span></span>
<span id="cb5-208"><a href="#cb5-208"></a></span>
<span id="cb5-209"><a href="#cb5-209"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">In mathematics, a finite field or Galois field (so-named in honor of Évariste Galois) is a field that has a finite number of elements. As with any field, a finite field is a set on which the operations of multiplication, addition, subtraction and division are defined and satisfy certain basic rules. The most common examples of finite fields are the integers mod p $p$ when $p$ is a prime number.</span><span class="co">](https://en.wikipedia.org/wiki/Finite_field)</span></span>
<span id="cb5-210"><a href="#cb5-210"></a></span>
<span id="cb5-211"><a href="#cb5-211"></a><span class="fu">## Recall</span></span>
<span id="cb5-212"><a href="#cb5-212"></a></span>
<span id="cb5-213"><a href="#cb5-213"></a><span class="ss">- </span>The<span class="in">`u`</span>$n$s and <span class="in">`i`</span>$n$'s in Rust are *rings*</span>
<span id="cb5-214"><a href="#cb5-214"></a><span class="ss">  - </span>They have addition and multiplication</span>
<span id="cb5-215"><a href="#cb5-215"></a><span class="ss">- </span>They aren't fields - zero is divisible</span>
<span id="cb5-216"><a href="#cb5-216"></a><span class="ss">  - </span>Spoiler alert, but $2^{\frac{n}{2}} \times 2^{\frac{n}{2}} \equiv 0 \pmod{2^n}$</span>
<span id="cb5-217"><a href="#cb5-217"></a><span class="ss">- </span>So: not $\mathbb{Z}/2^8\mathbb{Z}$</span>
<span id="cb5-218"><a href="#cb5-218"></a><span class="ss">    - </span>What about $\mathbb{Z}/(2^8+1)\mathbb{Z}$? </span>
<span id="cb5-219"><a href="#cb5-219"></a><span class="ss">        - </span>That's $\mathbb{F}_p$ where $p = 2^8+1$</span>
<span id="cb5-220"><a href="#cb5-220"></a>        </span>
<span id="cb5-221"><a href="#cb5-221"></a><span class="fu">## Iterative Definition</span></span>
<span id="cb5-222"><a href="#cb5-222"></a></span>
<span id="cb5-223"><a href="#cb5-223"></a>An EdDSA signature scheme is a choice over:</span>
<span id="cb5-224"><a href="#cb5-224"></a></span>
<span id="cb5-225"><a href="#cb5-225"></a><span class="ss">- </span>A finite field $\mathbb{F}_p$.</span>
<span id="cb5-226"><a href="#cb5-226"></a><span class="ss">- </span>An elliptic curve $E$ over $\mathbb{F}_p$</span>
<span id="cb5-227"><a href="#cb5-227"></a><span class="ss">    - </span>We simply as:</span>
<span id="cb5-228"><a href="#cb5-228"></a><span class="ss">        - </span>A plane curve over</span>
<span id="cb5-229"><a href="#cb5-229"></a><span class="ss">        - </span>A finite field</span>
<span id="cb5-230"><a href="#cb5-230"></a><span class="ss">        - </span>of form $a x^2+y^2= 1+dx^2y^2$</span>
<span id="cb5-231"><a href="#cb5-231"></a></span>
<span id="cb5-232"><a href="#cb5-232"></a><span class="fu">## Plane Curve</span></span>
<span id="cb5-233"><a href="#cb5-233"></a></span>
<span id="cb5-234"><a href="#cb5-234"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">In mathematics, a plane curve is a curve in a plane that may be a Euclidean plane, an affine plane or a projective plane. The most frequently studied cases are smooth plane curves (including piecewise smooth plane curves), and algebraic plane curves. Plane curves also include the Jordan curves (curves that enclose a region of the plane but need not be smooth) and the graphs of continuous functions.</span><span class="co">](https://en.wikipedia.org/wiki/Plane_curve)</span></span>
<span id="cb5-235"><a href="#cb5-235"></a></span>
<span id="cb5-236"><a href="#cb5-236"></a><span class="fu">## Graphs of Continous Functions</span></span>
<span id="cb5-237"><a href="#cb5-237"></a></span>
<span id="cb5-238"><a href="#cb5-238"></a><span class="ss">- </span>Often express as $f(x,y) = 0$</span>
<span id="cb5-239"><a href="#cb5-239"></a></span>
<span id="cb5-240"><a href="#cb5-240"></a>::::{.columns}</span>
<span id="cb5-241"><a href="#cb5-241"></a></span>
<span id="cb5-242"><a href="#cb5-242"></a>:::{.column width="50%"}</span>
<span id="cb5-243"><a href="#cb5-243"></a></span>
<span id="cb5-244"><a href="#cb5-244"></a><span class="in">```py</span></span>
<span id="cb5-245"><a href="#cb5-245"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-246"><a href="#cb5-246"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-247"><a href="#cb5-247"></a><span class="im">import</span> sympy</span>
<span id="cb5-248"><a href="#cb5-248"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb5-249"><a href="#cb5-249"></a></span>
<span id="cb5-250"><a href="#cb5-250"></a>r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-251"><a href="#cb5-251"></a></span>
<span id="cb5-252"><a href="#cb5-252"></a>curve <span class="op">=</span> sympy.Eq(<span class="dv">0</span>,x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> r)</span>
<span id="cb5-253"><a href="#cb5-253"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb5-254"><a href="#cb5-254"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb5-255"><a href="#cb5-255"></a></span>
<span id="cb5-256"><a href="#cb5-256"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span>r, r, <span class="dv">1000</span>)</span>
<span id="cb5-257"><a href="#cb5-257"></a></span>
<span id="cb5-258"><a href="#cb5-258"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span>
<span id="cb5-259"><a href="#cb5-259"></a><span class="in">```</span></span>
<span id="cb5-260"><a href="#cb5-260"></a></span>
<span id="cb5-261"><a href="#cb5-261"></a>:::</span>
<span id="cb5-262"><a href="#cb5-262"></a></span>
<span id="cb5-263"><a href="#cb5-263"></a>:::{.column width="50%"}</span>
<span id="cb5-264"><a href="#cb5-264"></a></span>
<span id="cb5-267"><a href="#cb5-267"></a><span class="in">```{python}</span></span>
<span id="cb5-268"><a href="#cb5-268"></a><span class="co">#| echo: false</span></span>
<span id="cb5-269"><a href="#cb5-269"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-270"><a href="#cb5-270"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-271"><a href="#cb5-271"></a><span class="im">import</span> sympy</span>
<span id="cb5-272"><a href="#cb5-272"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb5-273"><a href="#cb5-273"></a></span>
<span id="cb5-274"><a href="#cb5-274"></a>r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-275"><a href="#cb5-275"></a></span>
<span id="cb5-276"><a href="#cb5-276"></a>curve <span class="op">=</span> sympy.Eq(<span class="dv">0</span>,x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> r)</span>
<span id="cb5-277"><a href="#cb5-277"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb5-278"><a href="#cb5-278"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb5-279"><a href="#cb5-279"></a></span>
<span id="cb5-280"><a href="#cb5-280"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span>r, r, <span class="dv">1000</span>)</span>
<span id="cb5-281"><a href="#cb5-281"></a></span>
<span id="cb5-282"><a href="#cb5-282"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span>
<span id="cb5-283"><a href="#cb5-283"></a><span class="in">```</span></span>
<span id="cb5-284"><a href="#cb5-284"></a></span>
<span id="cb5-285"><a href="#cb5-285"></a>:::</span>
<span id="cb5-286"><a href="#cb5-286"></a></span>
<span id="cb5-287"><a href="#cb5-287"></a>::::</span>
<span id="cb5-288"><a href="#cb5-288"></a></span>
<span id="cb5-289"><a href="#cb5-289"></a><span class="fu">## Iterative Definition</span></span>
<span id="cb5-290"><a href="#cb5-290"></a></span>
<span id="cb5-291"><a href="#cb5-291"></a>An EdDSA signature scheme is a choice over:</span>
<span id="cb5-292"><a href="#cb5-292"></a></span>
<span id="cb5-293"><a href="#cb5-293"></a><span class="ss">- </span>A finite field $\mathbb{F}_p$.</span>
<span id="cb5-294"><a href="#cb5-294"></a><span class="ss">- </span>An elliptic curve $E$ over $\mathbb{F}_p$</span>
<span id="cb5-295"><a href="#cb5-295"></a><span class="ss">    - </span>Whose group $E(\mathbb{F}_p)$ of $\mathbb{F}_p$-rational points has order $|E(\mathbb{F}_p)| = 2^C \ell$ where $\ell$ is a large primce and $2^c$ is the cofactor</span>
<span id="cb5-296"><a href="#cb5-296"></a><span class="ss">        - </span>Take a 400-level math class</span>
<span id="cb5-297"><a href="#cb5-297"></a><span class="ss">        - </span>Basically this is a measure of the area within the ellipse.</span>
<span id="cb5-298"><a href="#cb5-298"></a></span>
<span id="cb5-299"><a href="#cb5-299"></a><span class="fu">## Iterative Definition</span></span>
<span id="cb5-300"><a href="#cb5-300"></a></span>
<span id="cb5-301"><a href="#cb5-301"></a>An EdDSA signature scheme is a choice over:</span>
<span id="cb5-302"><a href="#cb5-302"></a></span>
<span id="cb5-303"><a href="#cb5-303"></a><span class="ss">- </span>A finite field $\mathbb{F}_p$.</span>
<span id="cb5-304"><a href="#cb5-304"></a><span class="ss">- </span>An elliptic curve $E$ over $\mathbb{F}_p$</span>
<span id="cb5-305"><a href="#cb5-305"></a><span class="ss">- </span>A base point $B \in E(\mathbb{F}_p)$</span>
<span id="cb5-306"><a href="#cb5-306"></a><span class="ss">    - </span>This is the only parameter set when generating your own keys.</span>
<span id="cb5-307"><a href="#cb5-307"></a><span class="ss">    - </span>Everything else is pre-computed.</span>
<span id="cb5-308"><a href="#cb5-308"></a><span class="ss">    - </span>Basically a point on the curve.</span>
<span id="cb5-309"><a href="#cb5-309"></a></span>
<span id="cb5-310"><a href="#cb5-310"></a><span class="fu">## Iterative Definition</span></span>
<span id="cb5-311"><a href="#cb5-311"></a></span>
<span id="cb5-312"><a href="#cb5-312"></a>An EdDSA signature scheme is a choice over:</span>
<span id="cb5-313"><a href="#cb5-313"></a></span>
<span id="cb5-314"><a href="#cb5-314"></a><span class="ss">- </span>A finite field $\mathbb{F}_p$.</span>
<span id="cb5-315"><a href="#cb5-315"></a><span class="ss">- </span>An elliptic curve $E$ over $\mathbb{F}_p$</span>
<span id="cb5-316"><a href="#cb5-316"></a><span class="ss">- </span>A base point $B \in E(\mathbb{F}_p)$</span>
<span id="cb5-317"><a href="#cb5-317"></a><span class="ss">- </span>A hash function $H$ with $2b$-bit outputs, where $2^{b-1} &gt; q$</span>
<span id="cb5-318"><a href="#cb5-318"></a><span class="ss">    - </span>This just allows machine representation.</span>
<span id="cb5-319"><a href="#cb5-319"></a>    </span>
<span id="cb5-320"><a href="#cb5-320"></a><span class="fu"># EdDSA, terms</span></span>
<span id="cb5-321"><a href="#cb5-321"></a></span>
<span id="cb5-322"><a href="#cb5-322"></a></span>
<span id="cb5-323"><a href="#cb5-323"></a><span class="fu">## Public key</span></span>
<span id="cb5-324"><a href="#cb5-324"></a></span>
<span id="cb5-325"><a href="#cb5-325"></a>::: {.callout-note}</span>
<span id="cb5-326"><a href="#cb5-326"></a><span class="fu">## Public key</span></span>
<span id="cb5-327"><a href="#cb5-327"></a></span>
<span id="cb5-328"><a href="#cb5-328"></a>An EdDSA *public key* is a curve point $A \in E(\mathbb{F}_p)$ encoded in $b$ bits</span>
<span id="cb5-329"><a href="#cb5-329"></a>:::</span>
<span id="cb5-330"><a href="#cb5-330"></a></span>
<span id="cb5-331"><a href="#cb5-331"></a><span class="fu">## Signature verification</span></span>
<span id="cb5-332"><a href="#cb5-332"></a></span>
<span id="cb5-333"><a href="#cb5-333"></a>::: {.callout-note}</span>
<span id="cb5-334"><a href="#cb5-334"></a><span class="fu">## Signature verification</span></span>
<span id="cb5-335"><a href="#cb5-335"></a></span>
<span id="cb5-336"><a href="#cb5-336"></a>An EdDSA *signature* on a message $M$ by public $A$ is the (ordered) pair $(R,S)$ encoded in $2b$ bits, where $R$ is a curve point $R \in E(\mathbb{F}_p)$ and $S$ is non-negative integer less than the size of the large prime $\ell$.  $(R,S)$ must satisfy the following equation (where $\parallel$ is string concatenation).</span>
<span id="cb5-337"><a href="#cb5-337"></a></span>
<span id="cb5-338"><a href="#cb5-338"></a>$$</span>
<span id="cb5-339"><a href="#cb5-339"></a>2^c S B = 2^c R + 2^c H(R \parallel A \parallel M) A</span>
<span id="cb5-340"><a href="#cb5-340"></a>$$</span>
<span id="cb5-341"><a href="#cb5-341"></a>:::</span>
<span id="cb5-342"><a href="#cb5-342"></a></span>
<span id="cb5-343"><a href="#cb5-343"></a><span class="fu">## Private key</span></span>
<span id="cb5-344"><a href="#cb5-344"></a></span>
<span id="cb5-345"><a href="#cb5-345"></a></span>
<span id="cb5-346"><a href="#cb5-346"></a>::: {.callout-note}</span>
<span id="cb5-347"><a href="#cb5-347"></a><span class="fu">## Private key</span></span>
<span id="cb5-348"><a href="#cb5-348"></a></span>
<span id="cb5-349"><a href="#cb5-349"></a>An EdDSA private key is a $b$-bit string $k$ which should be chosen uniformly at random.  The corresponding public key is $A = s B$, where $s = H_{0,\dots,b - 1}(k)$ is the least significant $b$ bits of $H(k)$ interpreted as an integer.</span>
<span id="cb5-350"><a href="#cb5-350"></a>:::</span>
<span id="cb5-351"><a href="#cb5-351"></a></span>
<span id="cb5-352"><a href="#cb5-352"></a><span class="fu">## Signing</span></span>
<span id="cb5-353"><a href="#cb5-353"></a></span>
<span id="cb5-354"><a href="#cb5-354"></a></span>
<span id="cb5-355"><a href="#cb5-355"></a>::: {.callout-note}</span>
<span id="cb5-356"><a href="#cb5-356"></a><span class="fu">## Signing</span></span>
<span id="cb5-357"><a href="#cb5-357"></a></span>
<span id="cb5-358"><a href="#cb5-358"></a>The signature on a message $M$ is deterministically computed as $(R, S)$ where $R = r B$ for $r = H(H_{b,\dots,2b - 1}(k) \parallel M)$, and </span>
<span id="cb5-359"><a href="#cb5-359"></a>$$</span>
<span id="cb5-360"><a href="#cb5-360"></a>S \equiv r + H(R \parallel A \parallel M) s \pmod \ell</span>
<span id="cb5-361"><a href="#cb5-361"></a>$$</span>
<span id="cb5-362"><a href="#cb5-362"></a>This satisfies the verification equation</span>
<span id="cb5-363"><a href="#cb5-363"></a>$$</span>
<span id="cb5-364"><a href="#cb5-364"></a>\begin{align}</span>
<span id="cb5-365"><a href="#cb5-365"></a>2^c S B &amp;= 2^c (r + H(R \parallel A \parallel M) s) B <span class="sc">\\</span></span>
<span id="cb5-366"><a href="#cb5-366"></a>        &amp;= 2^c r B + 2^c H(R \parallel A \parallel M) s B <span class="sc">\\</span></span>
<span id="cb5-367"><a href="#cb5-367"></a>        &amp;= 2^c R + 2^c H(R \parallel A \parallel M) A.</span>
<span id="cb5-368"><a href="#cb5-368"></a>\end{align}</span>
<span id="cb5-369"><a href="#cb5-369"></a>$$</span>
<span id="cb5-370"><a href="#cb5-370"></a>:::</span>
<span id="cb5-371"><a href="#cb5-371"></a></span>
<span id="cb5-372"><a href="#cb5-372"></a></span>
<span id="cb5-373"><a href="#cb5-373"></a><span class="fu"># EdDSA, Ed25519</span></span>
<span id="cb5-374"><a href="#cb5-374"></a></span>
<span id="cb5-375"><a href="#cb5-375"></a><span class="fu">## Ed25519</span></span>
<span id="cb5-376"><a href="#cb5-376"></a></span>
<span id="cb5-377"><a href="#cb5-377"></a><span class="ss">- </span>EdDSA with:</span>
<span id="cb5-378"><a href="#cb5-378"></a><span class="ss">    - </span>SHA-512</span>
<span id="cb5-379"><a href="#cb5-379"></a><span class="ss">    - </span>Curve25519</span>
<span id="cb5-380"><a href="#cb5-380"></a>    </span>
<span id="cb5-381"><a href="#cb5-381"></a><span class="fu">## Curve25519</span></span>
<span id="cb5-382"><a href="#cb5-382"></a></span>
<span id="cb5-383"><a href="#cb5-383"></a><span class="ss">- </span>An unusually fast curve to calculate on modern CPUs</span>
<span id="cb5-384"><a href="#cb5-384"></a><span class="ss">- </span>*Not* made me the NSA, and released after an NSA released curve was discovered to have a backdoor.</span>
<span id="cb5-385"><a href="#cb5-385"></a><span class="ss">- </span>Named for being over the prime field $2^{255}-19$ - hence 25519</span>
<span id="cb5-386"><a href="#cb5-386"></a></span>
<span id="cb5-387"><a href="#cb5-387"></a></span>
<span id="cb5-388"><a href="#cb5-388"></a></span>
<span id="cb5-389"><a href="#cb5-389"></a><span class="fu">## Visualize</span></span>
<span id="cb5-390"><a href="#cb5-390"></a></span>
<span id="cb5-391"><a href="#cb5-391"></a>::::{.columns}</span>
<span id="cb5-392"><a href="#cb5-392"></a></span>
<span id="cb5-393"><a href="#cb5-393"></a>:::{.column width="50%"}</span>
<span id="cb5-394"><a href="#cb5-394"></a></span>
<span id="cb5-395"><a href="#cb5-395"></a><span class="in">```py</span></span>
<span id="cb5-396"><a href="#cb5-396"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-397"><a href="#cb5-397"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-398"><a href="#cb5-398"></a><span class="im">import</span> sympy</span>
<span id="cb5-399"><a href="#cb5-399"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb5-400"><a href="#cb5-400"></a></span>
<span id="cb5-401"><a href="#cb5-401"></a>curve <span class="op">=</span> sympy.Eq(y<span class="op">*</span>y, x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">486662</span><span class="op">*</span>x<span class="op">*</span>x <span class="op">+</span> x)</span>
<span id="cb5-402"><a href="#cb5-402"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb5-403"><a href="#cb5-403"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb5-404"><a href="#cb5-404"></a></span>
<span id="cb5-405"><a href="#cb5-405"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">.00001</span>, <span class="fl">.00001</span>, <span class="dv">1000</span>)</span>
<span id="cb5-406"><a href="#cb5-406"></a></span>
<span id="cb5-407"><a href="#cb5-407"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span>
<span id="cb5-408"><a href="#cb5-408"></a><span class="in">```</span></span>
<span id="cb5-409"><a href="#cb5-409"></a></span>
<span id="cb5-410"><a href="#cb5-410"></a>:::</span>
<span id="cb5-411"><a href="#cb5-411"></a></span>
<span id="cb5-412"><a href="#cb5-412"></a>:::{.column width="50%"}</span>
<span id="cb5-413"><a href="#cb5-413"></a></span>
<span id="cb5-416"><a href="#cb5-416"></a><span class="in">```{python}</span></span>
<span id="cb5-417"><a href="#cb5-417"></a><span class="co">#| echo: false</span></span>
<span id="cb5-418"><a href="#cb5-418"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-419"><a href="#cb5-419"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-420"><a href="#cb5-420"></a><span class="im">import</span> sympy</span>
<span id="cb5-421"><a href="#cb5-421"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb5-422"><a href="#cb5-422"></a></span>
<span id="cb5-423"><a href="#cb5-423"></a>curve <span class="op">=</span> sympy.Eq(y<span class="op">*</span>y, x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">486662</span><span class="op">*</span>x<span class="op">*</span>x <span class="op">+</span> x)</span>
<span id="cb5-424"><a href="#cb5-424"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb5-425"><a href="#cb5-425"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb5-426"><a href="#cb5-426"></a></span>
<span id="cb5-427"><a href="#cb5-427"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="fl">.00001</span>, <span class="fl">.00001</span>, <span class="dv">1000</span>)</span>
<span id="cb5-428"><a href="#cb5-428"></a></span>
<span id="cb5-429"><a href="#cb5-429"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span>
<span id="cb5-430"><a href="#cb5-430"></a><span class="in">```</span></span>
<span id="cb5-431"><a href="#cb5-431"></a></span>
<span id="cb5-432"><a href="#cb5-432"></a>:::</span>
<span id="cb5-433"><a href="#cb5-433"></a></span>
<span id="cb5-434"><a href="#cb5-434"></a>::::</span>
<span id="cb5-435"><a href="#cb5-435"></a></span>
<span id="cb5-436"><a href="#cb5-436"></a><span class="fu">## Bernstein</span></span>
<span id="cb5-437"><a href="#cb5-437"></a></span>
<span id="cb5-438"><a href="#cb5-438"></a><span class="ss">- </span>Discovered by a team including Daniel J. Bernstein.</span>
<span id="cb5-439"><a href="#cb5-439"></a></span>
<span id="cb5-440"><a href="#cb5-440"></a><span class="at">&gt; The export of cryptography from the United States was controlled as a munition starting from the Cold War until recategorization in 1996, with further relaxation in the late 1990s. In 1995, Bernstein brought the court case Bernstein v. United States. The ruling in the case declared that software was protected speech under the First Amendment, which contributed to regulatory changes reducing controls on encryption.</span></span>
<span id="cb5-441"><a href="#cb5-441"></a></span>
<span id="cb5-442"><a href="#cb5-442"></a><span class="fu">## Lange</span></span>
<span id="cb5-443"><a href="#cb5-443"></a></span>
<span id="cb5-444"><a href="#cb5-444"></a><span class="ss">- </span>Discovered by a team including Tanja Lange.</span>
<span id="cb5-445"><a href="#cb5-445"></a><span class="ss">    - </span>Academic and anti-surveillance activist</span>
<span id="cb5-446"><a href="#cb5-446"></a><span class="ss">    - </span>Easy to find website with public keys:</span>
<span id="cb5-447"><a href="#cb5-447"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Peep these keys!</span><span class="co">](https://hyperelliptic.org/tanja/)</span></span>
<span id="cb5-448"><a href="#cb5-448"></a></span>
<span id="cb5-449"><a href="#cb5-449"></a></span>
<span id="cb5-450"><a href="#cb5-450"></a></span>
<span id="cb5-451"><a href="#cb5-451"></a><span class="fu">## $p$</span></span>
<span id="cb5-452"><a href="#cb5-452"></a></span>
<span id="cb5-453"><a href="#cb5-453"></a><span class="ss">- </span>$p = 2^255-19$ so </span>
<span id="cb5-454"><a href="#cb5-454"></a><span class="ss">- </span>$F_p = \mathbb{F}_{2^{255}-19}$</span>
<span id="cb5-455"><a href="#cb5-455"></a></span>
<span id="cb5-456"><a href="#cb5-456"></a></span>
<span id="cb5-457"><a href="#cb5-457"></a><span class="fu">## $E/\mathbb{F}_{2^{255}-19}$</span></span>
<span id="cb5-458"><a href="#cb5-458"></a></span>
<span id="cb5-459"><a href="#cb5-459"></a><span class="ss">- </span>Take the "twisted Edwards curve"</span>
<span id="cb5-460"><a href="#cb5-460"></a></span>
<span id="cb5-461"><a href="#cb5-461"></a>$$</span>
<span id="cb5-462"><a href="#cb5-462"></a>-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2</span>
<span id="cb5-463"><a href="#cb5-463"></a>$$</span>
<span id="cb5-464"><a href="#cb5-464"></a></span>
<span id="cb5-465"><a href="#cb5-465"></a></span>
<span id="cb5-466"><a href="#cb5-466"></a></span>
<span id="cb5-467"><a href="#cb5-467"></a><span class="fu">## Visualize</span></span>
<span id="cb5-468"><a href="#cb5-468"></a></span>
<span id="cb5-469"><a href="#cb5-469"></a>::::{.columns}</span>
<span id="cb5-470"><a href="#cb5-470"></a></span>
<span id="cb5-471"><a href="#cb5-471"></a>:::{.column width="50%"}</span>
<span id="cb5-472"><a href="#cb5-472"></a></span>
<span id="cb5-473"><a href="#cb5-473"></a><span class="in">```py</span></span>
<span id="cb5-474"><a href="#cb5-474"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-475"><a href="#cb5-475"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-476"><a href="#cb5-476"></a><span class="im">import</span> sympy</span>
<span id="cb5-477"><a href="#cb5-477"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb5-478"><a href="#cb5-478"></a></span>
<span id="cb5-479"><a href="#cb5-479"></a>curve <span class="op">=</span> sympy.Eq(<span class="op">-</span>x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y, <span class="dv">1</span> <span class="op">-</span> (<span class="dv">121665</span><span class="op">/</span><span class="dv">121666</span>)<span class="op">*</span>x<span class="op">*</span>x<span class="op">*</span>y<span class="op">*</span>y)</span>
<span id="cb5-480"><a href="#cb5-480"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb5-481"><a href="#cb5-481"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb5-482"><a href="#cb5-482"></a></span>
<span id="cb5-483"><a href="#cb5-483"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb5-484"><a href="#cb5-484"></a></span>
<span id="cb5-485"><a href="#cb5-485"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span>
<span id="cb5-486"><a href="#cb5-486"></a><span class="in">```</span></span>
<span id="cb5-487"><a href="#cb5-487"></a></span>
<span id="cb5-488"><a href="#cb5-488"></a>:::</span>
<span id="cb5-489"><a href="#cb5-489"></a></span>
<span id="cb5-490"><a href="#cb5-490"></a>:::{.column width="50%"}</span>
<span id="cb5-491"><a href="#cb5-491"></a></span>
<span id="cb5-494"><a href="#cb5-494"></a><span class="in">```{python}</span></span>
<span id="cb5-495"><a href="#cb5-495"></a><span class="co">#| echo: false</span></span>
<span id="cb5-496"><a href="#cb5-496"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-497"><a href="#cb5-497"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-498"><a href="#cb5-498"></a><span class="im">import</span> sympy</span>
<span id="cb5-499"><a href="#cb5-499"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y</span>
<span id="cb5-500"><a href="#cb5-500"></a></span>
<span id="cb5-501"><a href="#cb5-501"></a>curve <span class="op">=</span> sympy.Eq(<span class="op">-</span>x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y, <span class="dv">1</span> <span class="op">-</span> (<span class="dv">121665</span><span class="op">/</span><span class="dv">121666</span>)<span class="op">*</span>x<span class="op">*</span>x<span class="op">*</span>y<span class="op">*</span>y)</span>
<span id="cb5-502"><a href="#cb5-502"></a>for_y <span class="op">=</span> sympy.solve(curve, y)</span>
<span id="cb5-503"><a href="#cb5-503"></a>f <span class="op">=</span> sympy.lambdify(x, for_y)</span>
<span id="cb5-504"><a href="#cb5-504"></a></span>
<span id="cb5-505"><a href="#cb5-505"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb5-506"><a href="#cb5-506"></a></span>
<span id="cb5-507"><a href="#cb5-507"></a>_ <span class="op">=</span> [plt.plot(x, y) <span class="cf">for</span> y <span class="kw">in</span> f(x)]</span>
<span id="cb5-508"><a href="#cb5-508"></a><span class="in">```</span></span>
<span id="cb5-509"><a href="#cb5-509"></a></span>
<span id="cb5-510"><a href="#cb5-510"></a>:::</span>
<span id="cb5-511"><a href="#cb5-511"></a></span>
<span id="cb5-512"><a href="#cb5-512"></a>::::</span>
<span id="cb5-513"><a href="#cb5-513"></a></span>
<span id="cb5-514"><a href="#cb5-514"></a><span class="fu">## Ed25519</span></span>
<span id="cb5-515"><a href="#cb5-515"></a></span>
<span id="cb5-516"><a href="#cb5-516"></a><span class="ss">- </span>$p = 2^{255}-19$ so </span>
<span id="cb5-517"><a href="#cb5-517"></a><span class="ss">- </span>$F_p = \mathbb{F}_{2^{255}-19}$</span>
<span id="cb5-518"><a href="#cb5-518"></a><span class="ss">- </span>$E/\mathbb{F}_{2^{255}-19}$ is $-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2$</span>
<span id="cb5-519"><a href="#cb5-519"></a></span>
<span id="cb5-520"><a href="#cb5-520"></a><span class="fu">## Ed25519</span></span>
<span id="cb5-521"><a href="#cb5-521"></a></span>
<span id="cb5-522"><a href="#cb5-522"></a><span class="ss">- </span>$p = 2^{255}-19$ so </span>
<span id="cb5-523"><a href="#cb5-523"></a><span class="ss">- </span>$F_p = \mathbb{F}_{2^{255}-19}$</span>
<span id="cb5-524"><a href="#cb5-524"></a><span class="ss">- </span>$E/\mathbb{F}_{2^{255}-19}$ is $-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2$</span>
<span id="cb5-525"><a href="#cb5-525"></a><span class="ss">- </span>$\ell = 2^{252} + 27742317777372353535851937790883648493$</span>
<span id="cb5-526"><a href="#cb5-526"></a></span>
<span id="cb5-527"><a href="#cb5-527"></a><span class="fu">## Ed25519</span></span>
<span id="cb5-528"><a href="#cb5-528"></a></span>
<span id="cb5-529"><a href="#cb5-529"></a><span class="ss">- </span>$p = 2^{255}-19$ so </span>
<span id="cb5-530"><a href="#cb5-530"></a><span class="ss">- </span>$F_p = \mathbb{F}_{2^{255}-19}$</span>
<span id="cb5-531"><a href="#cb5-531"></a><span class="ss">- </span>$E/\mathbb{F}_{2^{255}-19}$ is $-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2$</span>
<span id="cb5-532"><a href="#cb5-532"></a><span class="ss">- </span>$\ell = 2^{252} + 27742317777372353535851937790883648493$</span>
<span id="cb5-533"><a href="#cb5-533"></a><span class="ss">- </span>$c = 3$</span>
<span id="cb5-534"><a href="#cb5-534"></a></span>
<span id="cb5-535"><a href="#cb5-535"></a></span>
<span id="cb5-536"><a href="#cb5-536"></a><span class="fu">## Ed25519</span></span>
<span id="cb5-537"><a href="#cb5-537"></a></span>
<span id="cb5-538"><a href="#cb5-538"></a><span class="ss">- </span>$p = 2^{255}-19$ so </span>
<span id="cb5-539"><a href="#cb5-539"></a><span class="ss">- </span>$F_p = \mathbb{F}_{2^{255}-19}$</span>
<span id="cb5-540"><a href="#cb5-540"></a><span class="ss">- </span>$E/\mathbb{F}_{2^{255}-19}$ is $-x^2 + y^2 = 1 - \frac{121665}{121666}x^2y^2$</span>
<span id="cb5-541"><a href="#cb5-541"></a><span class="ss">- </span>$\ell = 2^{252} + 27742317777372353535851937790883648493$</span>
<span id="cb5-542"><a href="#cb5-542"></a><span class="ss">- </span>$c = 3$</span>
<span id="cb5-543"><a href="#cb5-543"></a></span>
<span id="cb5-544"><a href="#cb5-544"></a></span>
<span id="cb5-545"><a href="#cb5-545"></a><span class="fu">## Ed25519, definitions</span></span>
<span id="cb5-546"><a href="#cb5-546"></a></span>
<span id="cb5-547"><a href="#cb5-547"></a><span class="ss">- </span>Take the "base point" $B$ to be the unique point with $y = \frac{4}{5}$ and "positive" $x$</span>
<span id="cb5-548"><a href="#cb5-548"></a><span class="ss">    - </span>$x$ to be positive via its *bit-encoding*</span>
<span id="cb5-549"><a href="#cb5-549"></a><span class="ss">        - </span>"positive" coordinates are even coordinates (least significant bit is cleared)</span>
<span id="cb5-550"><a href="#cb5-550"></a><span class="ss">        - </span>"negative" coordinates are odd coordinates (least significant bit is set)</span>
<span id="cb5-551"><a href="#cb5-551"></a><span class="ss">- </span>Then let $H$ be SHA-512, given a $b$ (bit size) of 256.</span>
<span id="cb5-552"><a href="#cb5-552"></a><span class="ss">    - </span>Hashes are of size $2b$</span>
<span id="cb5-553"><a href="#cb5-553"></a></span>
<span id="cb5-554"><a href="#cb5-554"></a><span class="fu"># Ed25519, Takeaways</span></span>
<span id="cb5-555"><a href="#cb5-555"></a></span>
<span id="cb5-556"><a href="#cb5-556"></a><span class="ss">- </span>EdDSA a combination of equations that require a choice of constants.</span>
<span id="cb5-557"><a href="#cb5-557"></a><span class="ss">- </span>Ed25519 is a uniquely good set of constants.</span>
<span id="cb5-558"><a href="#cb5-558"></a><span class="ss">- </span>Together, they are basically a function that makes public and private keys.</span>
<span id="cb5-559"><a href="#cb5-559"></a><span class="ss">    - </span>A public key tells someone how to encrypt something so that only someone with...</span>
<span id="cb5-560"><a href="#cb5-560"></a><span class="ss">    - </span>The corresponding private key can decrypt it</span>
<span id="cb5-561"><a href="#cb5-561"></a><span class="ss">- </span>Used to sign bitcoin, git commits, e-commerce...</span>
<span id="cb5-562"><a href="#cb5-562"></a></span>
<span id="cb5-563"><a href="#cb5-563"></a><span class="fu">## Learn More</span></span>
<span id="cb5-564"><a href="#cb5-564"></a></span>
<span id="cb5-565"><a href="#cb5-565"></a><span class="ss">- </span>The best way to understand Ed25519 is to implement it.</span>
<span id="cb5-566"><a href="#cb5-566"></a><span class="ss">    - </span>It was released as software in Python, though Python 2.</span>
<span id="cb5-567"><a href="#cb5-567"></a><span class="ss">    - </span>You will implement in Rust.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>